(()=>{"use strict";class t{constructor(){this.board=[],this.createBoard(),this.hits=[],this.misses=[],this.placedShips=[],this.gameOver=!1}createBoard(){let t=0;for(let e=0;e<10;e++){this.board[e]=[];for(let i=0;i<10;i++)t++,this.board[e][i]=t}}placeShip(t,e,i){if(i&&!0===this.validPlacement(e,t.length,!0)){for(let i=0;i<t.length;i++){for(let i=0;i<this.board.length;i++)if(this.board[i].includes(e)){let s=this.board[i].indexOf(e);this.board[i][s]=t.name}e+=10}this.placedShips.push(t)}else if(!i&&!0===this.validPlacement(e,t.length,!1)){for(let i=0;i<t.length;i++){for(let i=0;i<this.board.length;i++)if(this.board[i].includes(e)){let s=this.board[i].indexOf(e);this.board[i][s]=t.name}e+=1}this.placedShips.push(t)}}recieveAttack(t){let e,i,s=t.toString();t<11?(e=t-1,i=0):100===t?(i=9,e=9):(i=parseInt(s.slice(0,1)),e=parseInt(s.slice(1,2))-1),Number.isInteger(this.board[i][e])?this.misses.push(t):(this.hits.push(t),this.placedShips.forEach((s=>{if(s.name===this.board[i][e])return s.hit(t),void s.isSunk()})))}isOver(){for(let t=0;t<this.placedShips.length;t++)if(this.placedShips[t].sunk=!1)return!1;return!0}validPlacement(t,e,i){let s,r,n=t.toString();if(t<11)s=t-1,r=0;else{if(100===t)return!1;r=parseInt(n.slice(0,1)),s=t%10==0?9:parseInt(n.slice(1,2))-1}if(i&&r+e>10)return!1;if(!i&&s+e>10)return!1;if(i)for(let t=0;t<e;t++){if(!Number.isInteger(this.board[r][s]))return!1;r++}else for(let t=0;t<e;t++){if(!Number.isInteger(this.board[r][s]))return!1;s++}return!0}randomlyPlaceShips(t){let e,i,s=!1;for(;!s;)e=Math.floor(100*Math.random())+1,i=Math.random()<.5,this.validPlacement(e,t.length,i)?(s=!0,this.placeShip(t,e,i)):s=!1}}class e{constructor(e,i){this.gameboard=new t,this.name=e,this.shots=[],this.oponent=i}attack(t,e){this.shots.includes(t)||(this.shots.push(t),e.gameboard.recieveAttack(t),e.gameboard.isOver())}randomAttack(t){let e,i=!1;for(;!i;)e=Math.floor(100*Math.random())+1,this.shots.includes(e)||(console.log(e),this.shots.push(e),t.gameboard.recieveAttack(e),i=!0)}}class i{constructor(t,e){this.length=t,this.isHit=[],this.sunk=!1,this.name=e}hit(t){if(!this.isHit.includes(t)&&this.isHit.length<this.length)return this.isHit.push(t),this.isHit}isSunk(){return this.isHit.length===this.length&&(this.sunk=!0,!0)}}!function(t){document.querySelector("body");const s=document.querySelector(".grid-container1");document.querySelector(".title-1").textContent="jjcrazyman";const r=document.querySelector(".grid-container2");document.querySelector(".title-2").textContent="Computer";let n=new e("human","computer"),a=new e("computer","human"),h=n.gameboard.board;[new i(5,"carrier"),new i(4,"destroyer"),new i(3,"submarine"),new i(2,"patrol")].forEach((t=>{a.gameboard.randomlyPlaceShips(t),n.gameboard.randomlyPlaceShips(t)}));for(let t=0;t<h.length;t++)for(let e=0;e<h[t].length;e++){const i=document.createElement("div");i.setAttribute("position",h[t][e]),Number.isInteger(h[t][e])||i.classList.add("ship-here"),i.classList.add("grid-item"),null==s||s.appendChild(i)}for(let t=0;t<h.length;t++)for(let e=0;e<h[t].length;e++){const i=document.createElement("div");i.setAttribute("position",h[t][e]),i.classList.add("grid-item"),i.classList.add("ai-grid"),i.addEventListener("click",(function(){Number.isInteger(h[t][e])?i.classList.add("miss"):i.classList.add("hit")})),null==r||r.appendChild(i)}document.querySelectorAll(".grid-item")}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQzlCLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJUixFQUFNTyxHQUFHTyxPQUFRTixJQUFLLENBQ3RDLE1BQU1zRCxFQUFXUCxTQUFTUSxjQUFjLE9BQ3hDRCxFQUFTRSxhQUFhLFdBQVloRSxFQUFNTyxHQUFHQyxJQUV0Q29CLE9BQU9DLFVBQVU3QixFQUFNTyxHQUFHQyxLQUMzQnNELEVBQVNHLFVBQVVDLElBQUksYUFFM0JKLEVBQVNHLFVBQVVDLElBQUksYUFDdkJULFNBQThDQSxFQUFNVSxZQUFZTCxFQUNwRSxDQUVKLElBQUssSUFBSXZELEVBQUksRUFBR0EsRUFBSVAsRUFBTWMsT0FBUVAsSUFDOUIsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlSLEVBQU1PLEdBQUdPLE9BQVFOLElBQUssQ0FDdEMsTUFBTXNELEVBQVdQLFNBQVNRLGNBQWMsT0FDeENELEVBQVNFLGFBQWEsV0FBWWhFLEVBQU1PLEdBQUdDLElBRTNDc0QsRUFBU0csVUFBVUMsSUFBSSxhQUN2QkosRUFBU0csVUFBVUMsSUFBSSxXQUN2QkosRUFBU00saUJBQWlCLFNBQVMsV0FDMUJ4QyxPQUFPQyxVQUFVN0IsRUFBTU8sR0FBR0MsSUFJM0JzRCxFQUFTRyxVQUFVQyxJQUFJLFFBSHZCSixFQUFTRyxVQUFVQyxJQUFJLE1BSy9CLElBQ0FQLFNBQThDQSxFQUFNUSxZQUFZTCxFQUNwRSxDQUVhUCxTQUFTYyxpQkFBaUIsYUFDL0MsQ0N0REFDLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9nYW1lYm9hcmQudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvcGxheWVycy50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9zaGlwLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvdWkvcmVuZGVyR2FtZUJvYXJkcy50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB7IFNoaXAgfSBmcm9tICcuL3NoaXAnXHJcbmV4cG9ydCBjbGFzcyBHYW1lQm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5ib2FyZCA9IFtdO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlQm9hcmQoKTtcclxuICAgICAgICB0aGlzLmhpdHMgPSBbXTtcclxuICAgICAgICB0aGlzLm1pc3NlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMucGxhY2VkU2hpcHMgPSBbXTtcclxuICAgICAgICB0aGlzLmdhbWVPdmVyID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBjcmVhdGVCb2FyZCgpIHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW2ldID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbaV1bal0gPSBjb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHBsYWNlU2hpcChzaGlwLCBzdGFydCwgdmVydGljYWwpIHtcclxuICAgICAgICBpZiAodmVydGljYWwgJiYgdGhpcy52YWxpZFBsYWNlbWVudChzdGFydCwgc2hpcC5sZW5ndGgsIHRydWUpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmJvYXJkLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRbal0uaW5jbHVkZXMoc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMuYm9hcmRbal0uaW5kZXhPZihzdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbal1baW5kZXhdID0gc2hpcC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXJ0ICs9IDEwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VkU2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoIXZlcnRpY2FsICYmIHRoaXMudmFsaWRQbGFjZW1lbnQoc3RhcnQsIHNoaXAubGVuZ3RoLCBmYWxzZSkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuYm9hcmQubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ib2FyZFtqXS5pbmNsdWRlcyhzdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5ib2FyZFtqXS5pbmRleE9mKHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtqXVtpbmRleF0gPSBzaGlwLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RhcnQgKz0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBsYWNlZFNoaXBzLnB1c2goc2hpcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVjaWV2ZUF0dGFjayhwb3NpdGlvbikge1xyXG4gICAgICAgIGxldCBjb2x1bW47XHJcbiAgICAgICAgbGV0IHN0ciA9IHBvc2l0aW9uLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IHJvdztcclxuICAgICAgICBpZiAocG9zaXRpb24gPCAxMSkge1xyXG4gICAgICAgICAgICBjb2x1bW4gPSBwb3NpdGlvbiAtIDE7XHJcbiAgICAgICAgICAgIHJvdyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvc2l0aW9uID09PSAxMDApIHtcclxuICAgICAgICAgICAgcm93ID0gOTtcclxuICAgICAgICAgICAgY29sdW1uID0gOTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJvdyA9IHBhcnNlSW50KHN0ci5zbGljZSgwLCAxKSk7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IHBhcnNlSW50KHN0ci5zbGljZSgxLCAyKSkgLSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGl0cy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5wbGFjZWRTaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNoaXAubmFtZSA9PT0gdGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzaGlwLmhpdChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcC5pc1N1bmsoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5taXNzZXMucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXNPdmVyKCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wbGFjZWRTaGlwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wbGFjZWRTaGlwc1tpXS5zdW5rID0gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgdmFsaWRQbGFjZW1lbnQocG9zaXRpb24sIGxlbmd0aCwgaXNWZXJ0aWNhbCkge1xyXG4gICAgICAgIC8vZ2V0IGNvbHVtbiBhbmQgcm93IGZyb20gcG9zaXRpb25cclxuICAgICAgICBsZXQgc3RyID0gcG9zaXRpb24udG9TdHJpbmcoKTtcclxuICAgICAgICBsZXQgY29sdW1uO1xyXG4gICAgICAgIGxldCByb3c7XHJcbiAgICAgICAgaWYgKHBvc2l0aW9uIDwgMTEpIHtcclxuICAgICAgICAgICAgY29sdW1uID0gcG9zaXRpb24gLSAxO1xyXG4gICAgICAgICAgICByb3cgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3NpdGlvbiA9PT0gMTAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJvdyA9IHBhcnNlSW50KHN0ci5zbGljZSgwLCAxKSk7XHJcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiAlIDEwID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb2x1bW4gPSA5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIGNvbHVtbiA9IHBhcnNlSW50KHN0ci5zbGljZSgxLCAyKSkgLSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNWZXJ0aWNhbCAmJiByb3cgKyBsZW5ndGggPiAxMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCFpc1ZlcnRpY2FsICYmIGNvbHVtbiArIGxlbmd0aCA+IDEwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzVmVydGljYWwpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHRoaXMuYm9hcmRbcm93XVtjb2x1bW5dKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJvdysrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByYW5kb21seVBsYWNlU2hpcHMoc2hpcCkge1xyXG4gICAgICAgIGxldCB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBwb3NpdGlvbjtcclxuICAgICAgICBsZXQgZGlyZWN0aW9uO1xyXG4gICAgICAgIHdoaWxlICghdmFsaWQpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsgMTtcclxuICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAuNSkge1xyXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkUGxhY2VtZW50KHBvc2l0aW9uLCBzaGlwLmxlbmd0aCwgZGlyZWN0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbGFjZVNoaXAoc2hpcCwgcG9zaXRpb24sIGRpcmVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgR2FtZUJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcbmV4cG9ydCBjbGFzcyBQbGF5ZXIge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgb3BvbmVudCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZWJvYXJkID0gbmV3IEdhbWVCb2FyZCgpO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5zaG90cyA9IFtdO1xyXG4gICAgICAgIHRoaXMub3BvbmVudCA9IG9wb25lbnQ7XHJcbiAgICB9XHJcbiAgICBhdHRhY2socG9zaXRpb24sIG9wb25lbnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc2hvdHMuaW5jbHVkZXMocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdHMucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIG9wb25lbnQuZ2FtZWJvYXJkLnJlY2lldmVBdHRhY2socG9zaXRpb24pO1xyXG4gICAgICAgICAgICBpZiAob3BvbmVudC5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2dcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJhbmRvbUF0dGFjayhvcHBvbmVudCkge1xyXG4gICAgICAgIGxldCB2YWxpZFNob3QgPSBmYWxzZTtcclxuICAgICAgICBsZXQgcG9zaXRpb247XHJcbiAgICAgICAgd2hpbGUgKCF2YWxpZFNob3QpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsgMTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNob3RzLmluY2x1ZGVzKHBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG90cy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIG9wcG9uZW50LmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIHZhbGlkU2hvdCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFNoaXAge1xyXG4gICAgY29uc3RydWN0b3IobGVuZ3RoLCBuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XHJcbiAgICAgICAgdGhpcy5pc0hpdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3VuayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB9XHJcbiAgICBoaXQocG9zaXRpb24pIHtcclxuICAgICAgICAvL3B1c2ggcG9zaXRpb24gdG8gaXNoaXQgYXJyYXlcclxuICAgICAgICBpZiAoIXRoaXMuaXNIaXQuaW5jbHVkZXMocG9zaXRpb24pICYmIHRoaXMuaXNIaXQubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0hpdC5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNIaXQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXNTdW5rKCkge1xyXG4gICAgICAgIC8vY2hlY2tzIGVhY2ggcG9zaXRpb24gb2Ygc2hpcCBmb3IgaGl0cyBpZiBhbGwgYXJlIGhpdCBpcyBzdW5rXHJcbiAgICAgICAgaWYgKHRoaXMuaXNIaXQubGVuZ3RoID09PSB0aGlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1bmsgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuLi9mYWN0b3JpZXMvcGxheWVyc1wiO1xyXG5pbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4uL2ZhY3Rvcmllcy9zaGlwXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlbmRlckdyaWRzKHBsYXllck5hbWUpIHtcclxuICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgICBjb25zdCBncmlkMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkLWNvbnRhaW5lcjEnKTtcclxuICAgIGNvbnN0IHRpdGxlMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50aXRsZS0xJyk7XHJcbiAgICB0aXRsZTEudGV4dENvbnRlbnQgPSBwbGF5ZXJOYW1lO1xyXG4gICAgY29uc3QgZ3JpZDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3JpZC1jb250YWluZXIyJyk7XHJcbiAgICBjb25zdCB0aXRsZTIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGl0bGUtMicpO1xyXG4gICAgdGl0bGUyLnRleHRDb250ZW50ID0gXCJDb21wdXRlclwiO1xyXG4gICAgbGV0IGh1bWFuID0gbmV3IFBsYXllcihcImh1bWFuXCIsIFwiY29tcHV0ZXJcIik7XHJcbiAgICBsZXQgY29tcHV0ZXIgPSBuZXcgUGxheWVyKFwiY29tcHV0ZXJcIiwgXCJodW1hblwiKTtcclxuICAgIGxldCBib2FyZCA9IGh1bWFuLmdhbWVib2FyZC5ib2FyZDtcclxuICAgIGxldCBjYXJyaWVyID0gbmV3IFNoaXAoNSwgXCJjYXJyaWVyXCIpO1xyXG4gICAgbGV0IGRlc3Ryb3llciA9IG5ldyBTaGlwKDQsIFwiZGVzdHJveWVyXCIpO1xyXG4gICAgbGV0IHN1Ym1hcmluZSA9IG5ldyBTaGlwKDMsIFwic3VibWFyaW5lXCIpO1xyXG4gICAgbGV0IHBhdHJvbCA9IG5ldyBTaGlwKDIsIFwicGF0cm9sXCIpO1xyXG4gICAgY29uc3QgYWxsU2hpcHMgPSBbY2FycmllciwgZGVzdHJveWVyLCBzdWJtYXJpbmUsIHBhdHJvbF07XHJcbiAgICAvLyBhbGxTaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgLy8gICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICAvLyAgICAgaHVtYW4uZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIC8vIH0pXHJcbiAgICBhbGxTaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIH0pO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9hcmRbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgZ3JpZEl0ZW0uc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIiwgYm9hcmRbaV1bal0pO1xyXG4gICAgICAgICAgICAvLyBncmlkSXRlbS50ZXh0Q29udGVudCA9IGJvYXJkW2ldW2pdXHJcbiAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihib2FyZFtpXVtqXSkpIHtcclxuICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoJ3NoaXAtaGVyZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoJ2dyaWQtaXRlbScpO1xyXG4gICAgICAgICAgICBncmlkMSA9PT0gbnVsbCB8fCBncmlkMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ3JpZDEuYXBwZW5kQ2hpbGQoZ3JpZEl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkW2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyaWRJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsIGJvYXJkW2ldW2pdKTtcclxuICAgICAgICAgICAgLy8gZ3JpZEl0ZW0udGV4dENvbnRlbnQgPSBib2FyZFtpXVtqXVxyXG4gICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKCdncmlkLWl0ZW0nKTtcclxuICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZCgnYWktZ3JpZCcpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihib2FyZFtpXVtqXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKCdoaXQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoJ21pc3MnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGdyaWQyID09PSBudWxsIHx8IGdyaWQyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBncmlkMi5hcHBlbmRDaGlsZChncmlkSXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1pdGVtJyk7XHJcbn1cclxuIiwiLy8gaW1wb3J0ICcuL3N0eWxlcy5jc3MnXHJcbmltcG9ydCByZW5kZXJHcmlkcyBmcm9tIFwiLi91aS9yZW5kZXJHYW1lQm9hcmRzXCI7XHJcbi8vIHN0YXJ0R2FtZSgpXHJcbnJlbmRlckdyaWRzKCdqamNyYXp5bWFuJyk7XHJcbiJdLCJuYW1lcyI6WyJHYW1lQm9hcmQiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJib2FyZCIsImNyZWF0ZUJvYXJkIiwiaGl0cyIsIm1pc3NlcyIsInBsYWNlZFNoaXBzIiwiZ2FtZU92ZXIiLCJjb3VudCIsImkiLCJqIiwicGxhY2VTaGlwIiwic2hpcCIsInN0YXJ0IiwidmVydGljYWwiLCJ2YWxpZFBsYWNlbWVudCIsImxlbmd0aCIsImluY2x1ZGVzIiwiaW5kZXgiLCJpbmRleE9mIiwibmFtZSIsInB1c2giLCJyZWNpZXZlQXR0YWNrIiwicG9zaXRpb24iLCJjb2x1bW4iLCJyb3ciLCJzdHIiLCJ0b1N0cmluZyIsInBhcnNlSW50Iiwic2xpY2UiLCJOdW1iZXIiLCJpc0ludGVnZXIiLCJmb3JFYWNoIiwiaGl0IiwiaXNTdW5rIiwiaXNPdmVyIiwic3VuayIsImlzVmVydGljYWwiLCJyYW5kb21seVBsYWNlU2hpcHMiLCJkaXJlY3Rpb24iLCJ2YWxpZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIlBsYXllciIsIm9wb25lbnQiLCJnYW1lYm9hcmQiLCJzaG90cyIsImF0dGFjayIsInJhbmRvbUF0dGFjayIsIm9wcG9uZW50IiwidmFsaWRTaG90IiwiY29uc29sZSIsImxvZyIsIlNoaXAiLCJpc0hpdCIsInBsYXllck5hbWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJncmlkMSIsInRleHRDb250ZW50IiwiZ3JpZDIiLCJodW1hbiIsImNvbXB1dGVyIiwiZ3JpZEl0ZW0iLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJhZGRFdmVudExpc3RlbmVyIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbmRlckdyaWRzIl0sInNvdXJjZVJvb3QiOiIifQ==