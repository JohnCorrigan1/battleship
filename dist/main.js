<<<<<<< HEAD
(()=>{"use strict";class e{constructor(){this.board=[],this.createBoard(),this.hits=[],this.misses=[],this.placedShips=[],this.gameOver=!1,this.sunkShips=[]}createBoard(){let e=0;for(let t=0;t<10;t++){this.board[t]=[];for(let s=0;s<10;s++)e++,this.board[t][s]=e}}placeShip(e,t,s){if(s&&!0===this.validPlacement(t,e.length,!0)){for(let s=0;s<e.length;s++){for(let s=0;s<this.board.length;s++)if(this.board[s].includes(t)){let n=this.board[s].indexOf(t);this.board[s][n]=e.name}t+=10}this.placedShips.push(e)}else if(!s&&!0===this.validPlacement(t,e.length,!1)){for(let s=0;s<e.length;s++){for(let s=0;s<this.board.length;s++)if(this.board[s].includes(t)){let n=this.board[s].indexOf(t);this.board[s][n]=e.name}t+=1}this.placedShips.push(e)}}recieveAttack(e,t){let s=e+t;Number.isInteger(this.board[e][t])?this.misses.push(s):(this.hits.push(s),this.placedShips.forEach((n=>{if(n.name===this.board[e][t])return n.hit(s),n.isSunk(),void(n.isSunk()&&this.sunkShips.push(n))})))}isOver(){return 4===this.sunkShips.length}validPlacement(e,t,s){let n=this.convertPosition(e),i=this.getRow(n),r=this.getCol(n);if(s&&i+t>10)return!1;if(!s&&r+t>10)return!1;if(s)for(let e=0;e<t;e++){if(!Number.isInteger(this.board[i][r]))return!1;i++}else for(let e=0;e<t;e++){if(!Number.isInteger(this.board[i][r]))return!1;r++}return!0}randomlyPlaceShips(e){let t,s,n=!1;for(;!n;)t=Math.floor(100*Math.random())+1,s=Math.random()<.5,this.validPlacement(t,e.length,s)?(n=!0,this.placeShip(e,t,s)):n=!1}convertPosition(e){let t,s,n=e.toString();return e<11?(t=e-1,s=0):100===e?(s=9,t=9):e%10==0?(s=parseInt(n.slice(0,1)),t=9):(s=parseInt(n.slice(0,1)),t=parseInt(n.slice(1,2))-1),s.toString()+t.toString()}getCol(e){return parseInt(e.slice(1,2))}getRow(e){return parseInt(e.slice(0,1))}}class t{constructor(t,s){this.gameboard=new e,this.name=t,this.shots=[],this.oponent=s}attack(e,t){let s=this.gameboard.convertPosition(e),n=this.gameboard.getRow(s),i=this.gameboard.getCol(s);this.shots.includes(e)||(this.shots.push(e),t.gameboard.recieveAttack(n,i),t.gameboard.isOver())}randomAttack(e){let t,s=!1;for(;!s;){t=Math.floor(100*Math.random())+1;let n=this.gameboard.convertPosition(t),i=this.gameboard.getRow(n),r=this.gameboard.getCol(n);if(!this.shots.includes(t))return console.log(t),this.shots.push(t),e.gameboard.recieveAttack(i,r),s=!0,t}}}class s{constructor(e,t){this.length=e,this.isHit=[],this.sunk=!1,this.name=t}hit(e){if(!this.isHit.includes(e)&&this.isHit.length<this.length)return this.isHit.push(e),this.isHit}isSunk(){return this.isHit.length===this.length&&(this.sunk=!0,!0)}}let n=new t("human","computer"),i=new t("computer","human"),r=n.gameboard.board,a=i.gameboard.board,o=new s(5,"carrier"),l=new s(4,"destroyer"),c=new s(3,"submarine"),d=new s(2,"patrol"),u=new s(5,"carrier"),h=new s(4,"destroyer"),m=new s(3,"submarine"),p=new s(2,"patrol");const g=[o,l,c,d],b=[u,h,m,p];let f=0;function S(e){if(f++,4===[].length)return;let t;const s=document.querySelector(".info");null==s||s.classList.remove("info"),null==s||s.classList.add("hide");const u=document.querySelector(".place");null==u||u.classList.remove("hide");const h=document.querySelector(".grid-container"),m=document.querySelector(".ships"),p=document.querySelector(".rotate"),v=document.querySelector(".carrier"),L=document.querySelector(".destroyer"),y=document.querySelector(".submarine"),C=document.querySelector(".patrol");if(1===f){null==p||p.addEventListener("click",(function(){(null==v?void 0:v.classList.contains("rotated"))?(null==m||m.classList.remove("ships-horizontal"),null==m||m.classList.add("ships-vertical"),v.classList.remove("rotated"),null==L||L.classList.remove("rotated"),null==y||y.classList.remove("rotated"),null==C||C.classList.remove("rotated")):(null==m||m.classList.remove("ships-vertical"),null==m||m.classList.add("ships-horizontal"),null==v||v.classList.add("rotated"),null==L||L.classList.add("rotated"),null==y||y.classList.add("rotated"),null==C||C.classList.add("rotated"))}));const t=document.querySelector(".start-game");null==t||t.addEventListener("click",(function(){u.innerHTML="",function(e){document.querySelector("body"),console.log(r);const t=document.querySelector(".place");null==t||t.classList.add("hide");const s=document.querySelector("#main");s.classList.remove("hide"),s.classList.add("main"),document.querySelector(".content"),document.querySelector(".grid1");const o=document.querySelector(".grid-container1");document.querySelector(".title-1").textContent=e;const l=document.querySelector(".sunken1"),c=(document.querySelector(".grid2"),document.querySelector(".grid-container2"));document.querySelector(".title-2").textContent="Computer";const d=document.querySelector(".sunken2"),u=document.querySelector(".who-won"),h=document.createElement("button");h.classList.add("restart"),h.textContent="Restart",h.addEventListener("click",(function(){location.reload()})),b.forEach((e=>{i.gameboard.randomlyPlaceShips(e)}));let m=0;for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++){m++;const s=document.createElement("div");s.setAttribute("hposition",m),Number.isInteger(r[e][t])||s.classList.add("ship-here"),s.classList.add("grid-item"),null==o||o.appendChild(s)}for(let t=0;t<a.length;t++)for(let s=0;s<a[t].length;s++){const o=document.createElement("div");o.setAttribute("cposition",a[t][s]),o.classList.add("grid-item"),o.classList.add("ai-grid"),o.addEventListener("click",(function(){if(o.classList.contains("hit")||o.classList.contains("miss")||n.gameboard.isOver()||i.gameboard.isOver())return;if(Number.isInteger(a[t][s]))o.classList.add("miss");else{o.classList.add("hit");let n=!1;if(i.gameboard.recieveAttack(t,s),i.gameboard.placedShips.forEach((e=>{e.name===a[t][s]&&(n=e.sunk)})),n){const n=document.createElement("h2");if(n.textContent=a[t][s],null==d||d.appendChild(n),i.gameboard.isOver()){const t=document.createElement("h1");t.textContent="Winner: "+e+"!",null==u||u.appendChild(t),null==u||u.appendChild(h)}}}let c;c=i.randomAttack(n);const m=document.querySelector(`[hposition="${c}"]`);let p=c,g=n.gameboard.convertPosition(p),b=n.gameboard.getRow(g),f=n.gameboard.getCol(g);if(Number.isInteger(n.gameboard.board[b][f]))null==m||m.classList.add("miss");else{null==m||m.classList.remove("ship-here"),null==m||m.classList.add("hit");let e=!1;if(n.gameboard.recieveAttack(t,s),n.gameboard.placedShips.forEach((t=>{t.name===r[b][f]&&(e=t.sunk)})),e){const e=document.createElement("h2");if(e.textContent=r[b][f],null==l||l.appendChild(e),n.gameboard.isOver()){const e=document.createElement("h1");e.textContent="Winner: Computer!",null==u||u.appendChild(e),null==u||u.appendChild(h)}}}})),null==c||c.appendChild(o)}}(e)}))}q();const E=document.querySelector(".randomly-place");function q(){let e=0;h.innerHTML="";for(let t=0;t<r.length;t++)for(let s=0;s<r[t].length;s++){e++;const n=document.createElement("div");n.setAttribute("data-hposition",e),Number.isInteger(r[t][s])||n.classList.add("ship-here"),n.classList.add("grid-item"),null==h||h.appendChild(n)}}null==E||E.addEventListener("click",(function(){g.forEach((e=>{n.gameboard.randomlyPlaceShips(e)})),E.disabled=!0,h.innerHTML="",q()})),document.querySelectorAll(".draggable").forEach((s=>{s.addEventListener("dragstart",(()=>{s.classList.add("dragging")})),s.addEventListener("dragend",(s=>{const i=s.target,r=parseInt(t.dataset.hposition);!function(e,t){if("carrier"===e)if(v.classList.contains("rotated")){if(!n.gameboard.validPlacement(t,5,!1))return void v.classList.remove("dragging");n.gameboard.placeShip(o,t,!1)}else n.gameboard.placeShip(o,t,!0);"destroyer"===e&&(v.classList.contains("rotated")?n.gameboard.placeShip(l,t,!1):n.gameboard.placeShip(l,t,!0)),"submarine"===e&&(v.classList.contains("rotated")?n.gameboard.placeShip(c,t,!1):n.gameboard.placeShip(c,t,!0)),"patrol"===e&&(v.classList.contains("rotated")?n.gameboard.placeShip(d,t,!1):n.gameboard.placeShip(d,t,!0))}(i.id,r),S(e)}))})),document.querySelectorAll(".grid-item").forEach((e=>{e.addEventListener("dragover",(e=>{t=e.target}))}))}!function(){const e=document.querySelector(".info"),t=document.createElement("div");t.classList.add("input-container");const s=document.createElement("label");s.textContent="Enter Name:";const n=document.createElement("input");n.classList.add("name-input");const i=document.createElement("button");i.classList.add("start-button"),i.textContent="Start",t.appendChild(s),t.appendChild(n),t.appendChild(i),null==e||e.appendChild(t),i.addEventListener("click",(function(){if(""!==n.value){const s=n.value;null==e||e.removeChild(t),S(s)}else{const s="To lazy to enter a name";null==e||e.removeChild(t),S(s)}}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cEQsU0FBU3lCLGNBQWMsT0FDOUMyQixFQUFlbEQsVUFBVUUsSUFBSSxtQkFDN0IsTUFBTWlELEVBQVlyRCxTQUFTeUIsY0FBYyxTQUN6QzRCLEVBQVVsQyxZQUFjLGNBQ3hCLE1BQU1tQyxFQUFZdEQsU0FBU3lCLGNBQWMsU0FDekM2QixFQUFVcEQsVUFBVUUsSUFBSSxjQUN4QixNQUFNVyxFQUFjZixTQUFTeUIsY0FBYyxVQUMzQ1YsRUFBWWIsVUFBVUUsSUFBSSxnQkFDMUJXLEVBQVlJLFlBQWMsUUFDMUJpQyxFQUFldEIsWUFBWXVCLEdBQzNCRCxFQUFldEIsWUFBWXdCLEdBQzNCRixFQUFldEIsWUFBWWYsR0FDM0JoQixTQUE0Q0EsRUFBSytCLFlBQVlzQixHQUM3RHJDLEVBQVlGLGlCQUFpQixTQUFTLFdBQ2xDLEdBQXdCLEtBQXBCeUMsRUFBVUMsTUFBYyxDQUN4QixNQUFNakgsRUFBT2dILEVBQVVDLE1BQ3ZCeEQsU0FBNENBLEVBQUt5RCxZQUFZSixHQUM3RHZILEVBQVVTLEVBQ2QsS0FDSyxDQUNELE1BQU1BLEVBQU8sMEJBQ2J5RCxTQUE0Q0EsRUFBS3lELFlBQVlKLEdBQzdEdkgsRUFBVVMsRUFDZCxDQUNKLEdBQ0osQ0MzQkFtSCxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvZ2FtZWJvYXJkLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL3BsYXllcnMudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvc2hpcC50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3VpL3BsYWNlU2hpcC50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3VpL3JlbmRlckdhbWVCb2FyZHMudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy91aS9zdGFydEdhbWUudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBTaGlwIH0gZnJvbSAnLi9zaGlwJ1xyXG5leHBvcnQgY2xhc3MgR2FtZUJvYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXTtcclxuICAgICAgICB0aGlzLmNyZWF0ZUJvYXJkKCk7XHJcbiAgICAgICAgdGhpcy5oaXRzID0gW107XHJcbiAgICAgICAgdGhpcy5taXNzZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnBsYWNlZFNoaXBzID0gW107XHJcbiAgICAgICAgdGhpcy5nYW1lT3ZlciA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc3Vua1NoaXBzID0gW107XHJcbiAgICB9XHJcbiAgICBjcmVhdGVCb2FyZCgpIHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW2ldID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbaV1bal0gPSBjb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHBsYWNlU2hpcChzaGlwLCBzdGFydCwgdmVydGljYWwpIHtcclxuICAgICAgICBpZiAodmVydGljYWwgJiYgdGhpcy52YWxpZFBsYWNlbWVudChzdGFydCwgc2hpcC5sZW5ndGgsIHRydWUpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmJvYXJkLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRbal0uaW5jbHVkZXMoc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMuYm9hcmRbal0uaW5kZXhPZihzdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbal1baW5kZXhdID0gc2hpcC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXJ0ICs9IDEwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VkU2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoIXZlcnRpY2FsICYmXHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRQbGFjZW1lbnQoc3RhcnQsIHNoaXAubGVuZ3RoLCBmYWxzZSkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuYm9hcmQubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ib2FyZFtqXS5pbmNsdWRlcyhzdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5ib2FyZFtqXS5pbmRleE9mKHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtqXVtpbmRleF0gPSBzaGlwLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RhcnQgKz0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBsYWNlZFNoaXBzLnB1c2goc2hpcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVjaWV2ZUF0dGFjayhyb3csIGNvbHVtbikge1xyXG4gICAgICAgIGxldCBwb3NpdGlvbiA9IHJvdyArIGNvbHVtbjtcclxuICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGl0cy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5wbGFjZWRTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hpcC5uYW1lID09PSB0aGlzLmJvYXJkW3Jvd11bY29sdW1uXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaXAuaGl0KHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBzaGlwLmlzU3VuaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLmlzU3VuaygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3Vua1NoaXBzLnB1c2goc2hpcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1pc3Nlcy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlzT3ZlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5zdW5rU2hpcHMubGVuZ3RoID09PSA0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YWxpZFBsYWNlbWVudChwb3NpdGlvbiwgbGVuZ3RoLCBpc1ZlcnRpY2FsKSB7XHJcbiAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gdGhpcy5jb252ZXJ0UG9zaXRpb24ocG9zaXRpb24pO1xyXG4gICAgICAgIGxldCByb3cgPSB0aGlzLmdldFJvdyhuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgbGV0IGNvbHVtbiA9IHRoaXMuZ2V0Q29sKG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICBpZiAoaXNWZXJ0aWNhbCAmJiByb3cgKyBsZW5ndGggPiAxMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCFpc1ZlcnRpY2FsICYmIGNvbHVtbiArIGxlbmd0aCA+IDEwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzVmVydGljYWwpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHRoaXMuYm9hcmRbcm93XVtjb2x1bW5dKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJvdysrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByYW5kb21seVBsYWNlU2hpcHMoc2hpcCkge1xyXG4gICAgICAgIGxldCB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBwb3NpdGlvbjtcclxuICAgICAgICBsZXQgZGlyZWN0aW9uO1xyXG4gICAgICAgIHdoaWxlICghdmFsaWQpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsgMTtcclxuICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjUpIHtcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy52YWxpZFBsYWNlbWVudChwb3NpdGlvbiwgc2hpcC5sZW5ndGgsIGRpcmVjdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxhY2VTaGlwKHNoaXAsIHBvc2l0aW9uLCBkaXJlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29udmVydFBvc2l0aW9uKHBvc2l0aW9uKSB7XHJcbiAgICAgICAgbGV0IGNvbHVtbjtcclxuICAgICAgICBsZXQgc3RyID0gcG9zaXRpb24udG9TdHJpbmcoKTtcclxuICAgICAgICBsZXQgcm93O1xyXG4gICAgICAgIGlmIChwb3NpdGlvbiA8IDExKSB7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IHBvc2l0aW9uIC0gMTtcclxuICAgICAgICAgICAgcm93ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocG9zaXRpb24gPT09IDEwMCkge1xyXG4gICAgICAgICAgICByb3cgPSA5O1xyXG4gICAgICAgICAgICBjb2x1bW4gPSA5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3NpdGlvbiAlIDEwID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJvdyA9IHBhcnNlSW50KHN0ci5zbGljZSgwLCAxKSk7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IDk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByb3cgPSBwYXJzZUludChzdHIuc2xpY2UoMCwgMSkpO1xyXG4gICAgICAgICAgICBjb2x1bW4gPSBwYXJzZUludChzdHIuc2xpY2UoMSwgMikpIC0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHN0clJvdyA9IHJvdy50b1N0cmluZygpO1xyXG4gICAgICAgIGxldCBzdHJDb2wgPSBjb2x1bW4udG9TdHJpbmcoKTtcclxuICAgICAgICBsZXQgbmV3UG9zaXRpb24gPSBzdHJSb3cgKyBzdHJDb2w7XHJcbiAgICAgICAgcmV0dXJuIG5ld1Bvc2l0aW9uO1xyXG4gICAgfVxyXG4gICAgZ2V0Q29sKHN0cikge1xyXG4gICAgICAgIHJldHVybiBwYXJzZUludChzdHIuc2xpY2UoMSwgMikpO1xyXG4gICAgfVxyXG4gICAgZ2V0Um93KHN0cikge1xyXG4gICAgICAgIHJldHVybiBwYXJzZUludChzdHIuc2xpY2UoMCwgMSkpO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IEdhbWVCb2FyZCB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5leHBvcnQgY2xhc3MgUGxheWVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUsIG9wb25lbnQpIHtcclxuICAgICAgICB0aGlzLmdhbWVib2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuc2hvdHMgPSBbXTtcclxuICAgICAgICB0aGlzLm9wb25lbnQgPSBvcG9uZW50O1xyXG4gICAgfVxyXG4gICAgYXR0YWNrKHBvc2l0aW9uLCBvcG9uZW50KSB7XHJcbiAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gdGhpcy5nYW1lYm9hcmQuY29udmVydFBvc2l0aW9uKHBvc2l0aW9uKTtcclxuICAgICAgICBsZXQgcm93ID0gdGhpcy5nYW1lYm9hcmQuZ2V0Um93KG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICBsZXQgY29sID0gdGhpcy5nYW1lYm9hcmQuZ2V0Q29sKG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICBpZiAoIXRoaXMuc2hvdHMuaW5jbHVkZXMocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdHMucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIG9wb25lbnQuZ2FtZWJvYXJkLnJlY2lldmVBdHRhY2socm93LCBjb2wpO1xyXG4gICAgICAgICAgICBpZiAob3BvbmVudC5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2dcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJhbmRvbUF0dGFjayhvcHBvbmVudCkge1xyXG4gICAgICAgIGxldCB2YWxpZFNob3QgPSBmYWxzZTtcclxuICAgICAgICBsZXQgcG9zaXRpb247XHJcbiAgICAgICAgd2hpbGUgKCF2YWxpZFNob3QpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsgMTtcclxuICAgICAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gdGhpcy5nYW1lYm9hcmQuY29udmVydFBvc2l0aW9uKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgbGV0IHJvdyA9IHRoaXMuZ2FtZWJvYXJkLmdldFJvdyhuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgICAgIGxldCBjb2wgPSB0aGlzLmdhbWVib2FyZC5nZXRDb2wobmV3UG9zaXRpb24pO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2hvdHMuaW5jbHVkZXMocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3RzLnB1c2gocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgb3Bwb25lbnQuZ2FtZWJvYXJkLnJlY2lldmVBdHRhY2socm93LCBjb2wpO1xyXG4gICAgICAgICAgICAgICAgdmFsaWRTaG90ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vIGxldCBzdHI6IHN0cmluZ1xyXG4gICAgICAgICAgICAgICAgLy8gc3RyID0gcm93LnRvU3RyaW5nKCkgKyBjb2wudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBTaGlwIHtcclxuICAgIGNvbnN0cnVjdG9yKGxlbmd0aCwgbmFtZSkge1xyXG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xyXG4gICAgICAgIHRoaXMuaXNIaXQgPSBbXTtcclxuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG4gICAgaGl0KHBvc2l0aW9uKSB7XHJcbiAgICAgICAgLy9wdXNoIHBvc2l0aW9uIHRvIGlzaGl0IGFycmF5XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzSGl0LmluY2x1ZGVzKHBvc2l0aW9uKSAmJiB0aGlzLmlzSGl0Lmxlbmd0aCA8IHRoaXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNIaXQucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzSGl0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlzU3VuaygpIHtcclxuICAgICAgICAvL2NoZWNrcyBlYWNoIHBvc2l0aW9uIG9mIHNoaXAgZm9yIGhpdHMgaWYgYWxsIGFyZSBoaXQgaXMgc3Vua1xyXG4gICAgICAgIGlmICh0aGlzLmlzSGl0Lmxlbmd0aCA9PT0gdGhpcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5zdW5rID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgcmVuZGVyR3JpZHMgZnJvbSBcIi4vcmVuZGVyR2FtZUJvYXJkc1wiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi8uLi9mYWN0b3JpZXMvcGxheWVyc1wiO1xyXG5pbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vLi4vZmFjdG9yaWVzL3NoaXBcIjtcclxubGV0IGh1bWFuID0gbmV3IFBsYXllcihcImh1bWFuXCIsIFwiY29tcHV0ZXJcIik7XHJcbmxldCBjb21wdXRlciA9IG5ldyBQbGF5ZXIoXCJjb21wdXRlclwiLCBcImh1bWFuXCIpO1xyXG5sZXQgaEJvYXJkID0gaHVtYW4uZ2FtZWJvYXJkLmJvYXJkO1xyXG5sZXQgY0JvYXJkID0gY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkO1xyXG5sZXQgaENhcnJpZXIgPSBuZXcgU2hpcCg1LCBcImNhcnJpZXJcIik7XHJcbmxldCBoRGVzdHJveWVyID0gbmV3IFNoaXAoNCwgXCJkZXN0cm95ZXJcIik7XHJcbmxldCBoU3VibWFyaW5lID0gbmV3IFNoaXAoMywgXCJzdWJtYXJpbmVcIik7XHJcbmxldCBoUGF0cm9sID0gbmV3IFNoaXAoMiwgXCJwYXRyb2xcIik7XHJcbmxldCBjQ2FycmllciA9IG5ldyBTaGlwKDUsIFwiY2FycmllclwiKTtcclxubGV0IGNEZXN0cm95ZXIgPSBuZXcgU2hpcCg0LCBcImRlc3Ryb3llclwiKTtcclxubGV0IGNTdWJtYXJpbmUgPSBuZXcgU2hpcCgzLCBcInN1Ym1hcmluZVwiKTtcclxubGV0IGNQYXRyb2wgPSBuZXcgU2hpcCgyLCBcInBhdHJvbFwiKTtcclxuY29uc3QgaHVtYW5TaGlwcyA9IFtoQ2FycmllciwgaERlc3Ryb3llciwgaFN1Ym1hcmluZSwgaFBhdHJvbF07XHJcbmNvbnN0IGNvbXB1dGVyU2hpcHMgPSBbY0NhcnJpZXIsIGNEZXN0cm95ZXIsIGNTdWJtYXJpbmUsIGNQYXRyb2xdO1xyXG5sZXQgY2FsbHMgPSAwO1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBwbGFjZVNoaXAocGxheWVyTmFtZSkge1xyXG4gICAgY2FsbHMrKztcclxuICAgIGNvbnN0IG1hbnVhbGx5UGxhY2VkU2hpcHMgPSBbXTtcclxuICAgIGlmIChtYW51YWxseVBsYWNlZFNoaXBzLmxlbmd0aCA9PT0gNCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCBwb3NpdGlvbjtcclxuICAgIGNvbnN0IGluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uY2xhc3NMaXN0LnJlbW92ZShcImluZm9cIik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XHJcbiAgICBjb25zdCBwbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VcIik7XHJcbiAgICBwbGFjZSA9PT0gbnVsbCB8fCBwbGFjZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGxhY2UuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XHJcbiAgICBjb25zdCBncmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkLWNvbnRhaW5lclwiKTtcclxuICAgIGNvbnN0IHNoaXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGlwc1wiKTtcclxuICAgIGNvbnN0IHJvdGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucm90YXRlXCIpO1xyXG4gICAgY29uc3QgY2FycmllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FycmllclwiKTtcclxuICAgIGNvbnN0IGRlc3Ryb3llciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVzdHJveWVyXCIpO1xyXG4gICAgY29uc3Qgc3VibWFyaW5lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdWJtYXJpbmVcIik7XHJcbiAgICBjb25zdCBwYXRyb2wgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBhdHJvbFwiKTtcclxuICAgIGlmIChjYWxscyA9PT0gMSkge1xyXG4gICAgICAgIHJvdGF0ZUJ1dHRvbiA9PT0gbnVsbCB8fCByb3RhdGVCdXR0b24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJvdGF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoY2FycmllciA9PT0gbnVsbCB8fCBjYXJyaWVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjYXJyaWVyLmNsYXNzTGlzdC5jb250YWlucyhcInJvdGF0ZWRcIikpIHtcclxuICAgICAgICAgICAgICAgIHNoaXBzID09PSBudWxsIHx8IHNoaXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaGlwcy5jbGFzc0xpc3QucmVtb3ZlKFwic2hpcHMtaG9yaXpvbnRhbFwiKTtcclxuICAgICAgICAgICAgICAgIHNoaXBzID09PSBudWxsIHx8IHNoaXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaGlwcy5jbGFzc0xpc3QuYWRkKFwic2hpcHMtdmVydGljYWxcIik7XHJcbiAgICAgICAgICAgICAgICBjYXJyaWVyLmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgZGVzdHJveWVyID09PSBudWxsIHx8IGRlc3Ryb3llciA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVzdHJveWVyLmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgc3VibWFyaW5lID09PSBudWxsIHx8IHN1Ym1hcmluZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3VibWFyaW5lLmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgcGF0cm9sID09PSBudWxsIHx8IHBhdHJvbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGF0cm9sLmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVkXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2hpcHMgPT09IG51bGwgfHwgc2hpcHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNoaXBzLmNsYXNzTGlzdC5yZW1vdmUoXCJzaGlwcy12ZXJ0aWNhbFwiKTtcclxuICAgICAgICAgICAgICAgIHNoaXBzID09PSBudWxsIHx8IHNoaXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaGlwcy5jbGFzc0xpc3QuYWRkKFwic2hpcHMtaG9yaXpvbnRhbFwiKTtcclxuICAgICAgICAgICAgICAgIGNhcnJpZXIgPT09IG51bGwgfHwgY2FycmllciA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2Fycmllci5jbGFzc0xpc3QuYWRkKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIGRlc3Ryb3llciA9PT0gbnVsbCB8fCBkZXN0cm95ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRlc3Ryb3llci5jbGFzc0xpc3QuYWRkKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIHN1Ym1hcmluZSA9PT0gbnVsbCB8fCBzdWJtYXJpbmUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN1Ym1hcmluZS5jbGFzc0xpc3QuYWRkKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIHBhdHJvbCA9PT0gbnVsbCB8fCBwYXRyb2wgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhdHJvbC5jbGFzc0xpc3QuYWRkKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdGFydC1nYW1lXCIpO1xyXG4gICAgICAgIHN0YXJ0QnV0dG9uID09PSBudWxsIHx8IHN0YXJ0QnV0dG9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBwbGFjZS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgcmVuZGVyR3JpZHMocGxheWVyTmFtZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBjaGVja0JvYXJkKCk7XHJcbiAgICBjb25zdCByYW5kb21seVBsYWNlID0gKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmFuZG9tbHktcGxhY2VcIikpO1xyXG4gICAgcmFuZG9tbHlQbGFjZSA9PT0gbnVsbCB8fCByYW5kb21seVBsYWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiByYW5kb21seVBsYWNlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaHVtYW5TaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmFuZG9tbHlQbGFjZS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgZ3JpZC5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgICAgIGNoZWNrQm9hcmQoKTtcclxuICAgIH0pO1xyXG4gICAgZnVuY3Rpb24gY2hlY2tCb2FyZCgpIHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGdyaWQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBoQm9hcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBoQm9hcmRbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBncmlkSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICBncmlkSXRlbS5zZXRBdHRyaWJ1dGUoXCJkYXRhLWhwb3NpdGlvblwiLCBjb3VudCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoaEJvYXJkW2ldW2pdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJzaGlwLWhlcmVcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwiZ3JpZC1pdGVtXCIpO1xyXG4gICAgICAgICAgICAgICAgZ3JpZCA9PT0gbnVsbCB8fCBncmlkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBncmlkLmFwcGVuZENoaWxkKGdyaWRJdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGV2ZW50cygpO1xyXG4gICAgZnVuY3Rpb24gZXZlbnRzKCkge1xyXG4gICAgICAgIGNvbnN0IGRyYWdnYWJsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmRyYWdnYWJsZVwiKTtcclxuICAgICAgICBkcmFnZ2FibGVzLmZvckVhY2goKGRyYWdnYWJsZSkgPT4ge1xyXG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcmFnZ2FibGUuY2xhc3NMaXN0LmFkZCgnZHJhZ2dpbmcnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCAoZXYpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNoaXBFbGVtZW50ID0gZXYudGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFBvcyA9IHBhcnNlSW50KHBvc2l0aW9uLmRhdGFzZXQuaHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNoaXBOYW1lID0gc2hpcEVsZW1lbnQuaWQ7XHJcbiAgICAgICAgICAgICAgICBwbGFjZVNoaXBEcmFnZ2VkKHNoaXBOYW1lLCBjdXJyZW50UG9zKTtcclxuICAgICAgICAgICAgICAgIHBsYWNlU2hpcChwbGF5ZXJOYW1lKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmdyaWQtaXRlbVwiKTtcclxuICAgICAgICBncmlkSXRlbS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBlLnRhcmdldDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBmdW5jdGlvbiBpc1ZhbGlkKHBvc2l0aW9uOiBudW1iZXIsIG5hbWU6IHN0cmluZyl7XHJcbiAgICAvLyAgIGxldCBkaXJlY3Rpb24gPSBmYWxzZTtcclxuICAgIC8vICAgaWYoY2Fycmllci5jbGFzc0xpc3QuY29udGFpbnMoXCJyb3RhdGVkXCIpKXtcclxuICAgIC8vICAgICBkaXJlY3Rpb24gPSB0cnVlO1xyXG4gICAgLy8gICB9XHJcbiAgICAvLyAgIGlmKG5hbWUgPT09IFwiY2FycmllclwiKXtcclxuICAgIC8vICAgICBodW1hbi5nYW1lYm9hcmQudmFsaWRQbGFjZW1lbnQocG9zaXRpb24sIDUsIGRpcmVjdGlvbilcclxuICAgIC8vICAgfVxyXG4gICAgLy8gfVxyXG4gICAgZnVuY3Rpb24gcGxhY2VTaGlwRHJhZ2dlZChzaGlwTmFtZSwgY3VycmVudFBvcykge1xyXG4gICAgICAgIGlmIChzaGlwTmFtZSA9PT0gXCJjYXJyaWVyXCIpIHtcclxuICAgICAgICAgICAgaWYgKGNhcnJpZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwicm90YXRlZFwiKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGh1bWFuLmdhbWVib2FyZC52YWxpZFBsYWNlbWVudChjdXJyZW50UG9zLCA1LCBmYWxzZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhDYXJyaWVyLCBjdXJyZW50UG9zLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXJyaWVyLmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcChoQ2FycmllciwgY3VycmVudFBvcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNoaXBOYW1lID09PSBcImRlc3Ryb3llclwiKSB7XHJcbiAgICAgICAgICAgIGlmIChjYXJyaWVyLmNsYXNzTGlzdC5jb250YWlucyhcInJvdGF0ZWRcIikpIHtcclxuICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoaERlc3Ryb3llciwgY3VycmVudFBvcywgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcChoRGVzdHJveWVyLCBjdXJyZW50UG9zLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2hpcE5hbWUgPT09IFwic3VibWFyaW5lXCIpIHtcclxuICAgICAgICAgICAgaWYgKGNhcnJpZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwicm90YXRlZFwiKSkge1xyXG4gICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcChoU3VibWFyaW5lLCBjdXJyZW50UG9zLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhTdWJtYXJpbmUsIGN1cnJlbnRQb3MsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGlwTmFtZSA9PT0gXCJwYXRyb2xcIikge1xyXG4gICAgICAgICAgICBpZiAoY2Fycmllci5jbGFzc0xpc3QuY29udGFpbnMoXCJyb3RhdGVkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhQYXRyb2wsIGN1cnJlbnRQb3MsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoaFBhdHJvbCwgY3VycmVudFBvcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0IHsgaHVtYW5TaGlwcywgY29tcHV0ZXJTaGlwcywgaHVtYW4sIGNvbXB1dGVyLCBoQm9hcmQsIGNCb2FyZCB9O1xyXG4iLCJpbXBvcnQgeyBjb21wdXRlclNoaXBzLCBodW1hbiwgY29tcHV0ZXIsIGhCb2FyZCwgY0JvYXJkIH0gZnJvbSBcIi4uL3VpL3BsYWNlU2hpcFwiO1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZW5kZXJHcmlkcyhwbGF5ZXJOYW1lKSB7XHJcbiAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XHJcbiAgICBjb25zb2xlLmxvZyhoQm9hcmQpO1xyXG4gICAgLy8gY29uc3QgaW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW5mb1wiKTtcclxuICAgIC8vIGluZm8/LmNsYXNzTGlzdC5yZW1vdmUoXCJpbmZvXCIpO1xyXG4gICAgLy8gaW5mbz8uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XHJcbiAgICBjb25zdCBwbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZScpO1xyXG4gICAgcGxhY2UgPT09IG51bGwgfHwgcGxhY2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBsYWNlLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21haW5cIik7XHJcbiAgICBtYWluLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xyXG4gICAgbWFpbi5jbGFzc0xpc3QuYWRkKFwibWFpblwiKTtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRlbnRcIik7XHJcbiAgICBjb25zdCBncmlkQ29udGFpbmVyMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZDFcIik7XHJcbiAgICBjb25zdCBncmlkMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZC1jb250YWluZXIxXCIpO1xyXG4gICAgY29uc3QgdGl0bGUxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50aXRsZS0xXCIpO1xyXG4gICAgdGl0bGUxLnRleHRDb250ZW50ID0gcGxheWVyTmFtZTtcclxuICAgIGNvbnN0IHN1bmtlbjEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN1bmtlbjFcIik7XHJcbiAgICBjb25zdCBncmlkQ29udGFpbmVyMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZDJcIik7XHJcbiAgICBjb25zdCBncmlkMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZC1jb250YWluZXIyXCIpO1xyXG4gICAgY29uc3QgdGl0bGUyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50aXRsZS0yXCIpO1xyXG4gICAgdGl0bGUyLnRleHRDb250ZW50ID0gXCJDb21wdXRlclwiO1xyXG4gICAgY29uc3Qgc3Vua2VuMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3Vua2VuMlwiKTtcclxuICAgIGNvbnN0IHdob1dvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2hvLXdvblwiKTtcclxuICAgIGNvbnN0IHJlc3RhcnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgcmVzdGFydC5jbGFzc0xpc3QuYWRkKFwicmVzdGFydFwiKTtcclxuICAgIHJlc3RhcnQudGV4dENvbnRlbnQgPSBcIlJlc3RhcnRcIjtcclxuICAgIHJlc3RhcnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgIH0pO1xyXG4gICAgLy8gbGV0IGh1bWFuID0gbmV3IFBsYXllcihcImh1bWFuXCIsIFwiY29tcHV0ZXJcIik7XHJcbiAgICAvLyBsZXQgY29tcHV0ZXIgPSBuZXcgUGxheWVyKFwiY29tcHV0ZXJcIiwgXCJodW1hblwiKTtcclxuICAgIC8vIGxldCBoQm9hcmQgPSBodW1hbi5nYW1lYm9hcmQuYm9hcmQ7XHJcbiAgICAvLyBsZXQgY0JvYXJkID0gY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkO1xyXG4gICAgLy8gbGV0IGhDYXJyaWVyID0gbmV3IFNoaXAoNSwgXCJjYXJyaWVyXCIpO1xyXG4gICAgLy8gbGV0IGhEZXN0cm95ZXIgPSBuZXcgU2hpcCg0LCBcImRlc3Ryb3llclwiKTtcclxuICAgIC8vIGxldCBoU3VibWFyaW5lID0gbmV3IFNoaXAoMywgXCJzdWJtYXJpbmVcIik7XHJcbiAgICAvLyBsZXQgaFBhdHJvbCA9IG5ldyBTaGlwKDIsIFwicGF0cm9sXCIpO1xyXG4gICAgLy8gbGV0IGNDYXJyaWVyID0gbmV3IFNoaXAoNSwgXCJjYXJyaWVyXCIpO1xyXG4gICAgLy8gbGV0IGNEZXN0cm95ZXIgPSBuZXcgU2hpcCg0LCBcImRlc3Ryb3llclwiKTtcclxuICAgIC8vIGxldCBjU3VibWFyaW5lID0gbmV3IFNoaXAoMywgXCJzdWJtYXJpbmVcIik7XHJcbiAgICAvLyBsZXQgY1BhdHJvbCA9IG5ldyBTaGlwKDIsIFwicGF0cm9sXCIpO1xyXG4gICAgLy8gY29uc3QgaHVtYW5TaGlwcyA9IFtoQ2FycmllciwgaERlc3Ryb3llciwgaFN1Ym1hcmluZSwgaFBhdHJvbF07XHJcbiAgICAvLyBjb25zdCBjb21wdXRlclNoaXBzID0gW2NDYXJyaWVyLCBjRGVzdHJveWVyLCBjU3VibWFyaW5lLCBjUGF0cm9sXTtcclxuICAgIC8vIGFsbFNoaXBzLmZvckVhY2goc2hpcCA9PiB7XHJcbiAgICAvLyAgICAgY29tcHV0ZXIuZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIC8vICAgICBodW1hbi5nYW1lYm9hcmQucmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApO1xyXG4gICAgLy8gfSlcclxuICAgIGNvbXB1dGVyU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICB9KTtcclxuICAgIC8vIGh1bWFuU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgLy8gICBodW1hbi5nYW1lYm9hcmQucmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApO1xyXG4gICAgLy8gfSk7XHJcbiAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBoQm9hcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGhCb2FyZFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICBjb25zdCBncmlkSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLnNldEF0dHJpYnV0ZShcImhwb3NpdGlvblwiLCBjb3VudCk7XHJcbiAgICAgICAgICAgIC8vIGdyaWRJdGVtLnRleHRDb250ZW50ID0gYm9hcmRbaV1bal1cclxuICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGhCb2FyZFtpXVtqXSkpIHtcclxuICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJzaGlwLWhlcmVcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcImdyaWQtaXRlbVwiKTtcclxuICAgICAgICAgICAgZ3JpZDEgPT09IG51bGwgfHwgZ3JpZDEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdyaWQxLmFwcGVuZENoaWxkKGdyaWRJdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNCb2FyZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY0JvYXJkW2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyaWRJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgZ3JpZEl0ZW0uc2V0QXR0cmlidXRlKFwiY3Bvc2l0aW9uXCIsIGNCb2FyZFtpXVtqXSk7XHJcbiAgICAgICAgICAgIC8vIGdyaWRJdGVtLnRleHRDb250ZW50ID0gYm9hcmRbaV1bal1cclxuICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcImdyaWQtaXRlbVwiKTtcclxuICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcImFpLWdyaWRcIik7XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZ3JpZEl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaGl0XCIpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwibWlzc1wiKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5pc092ZXIoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5pc092ZXIoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihjQm9hcmRbaV1bal0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcImhpdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaXNTdW5rID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXIuZ2FtZWJvYXJkLnJlY2lldmVBdHRhY2soaSwgaik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXIuZ2FtZWJvYXJkLnBsYWNlZFNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoaXAubmFtZSA9PT0gY0JvYXJkW2ldW2pdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1N1bmsgPSBzaGlwLnN1bms7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdW5rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bmtlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vua2VuLnRleHRDb250ZW50ID0gY0JvYXJkW2ldW2pdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdW5rZW4yID09PSBudWxsIHx8IHN1bmtlbjIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN1bmtlbjIuYXBwZW5kQ2hpbGQoc3Vua2VuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXB1dGVyLmdhbWVib2FyZC5pc092ZXIoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2lubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lubmVyLnRleHRDb250ZW50ID0gXCJXaW5uZXI6IFwiICsgcGxheWVyTmFtZSArIFwiIVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hvV29uID09PSBudWxsIHx8IHdob1dvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogd2hvV29uLmFwcGVuZENoaWxkKHdpbm5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aG9Xb24gPT09IG51bGwgfHwgd2hvV29uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB3aG9Xb24uYXBwZW5kQ2hpbGQocmVzdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBwb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gY29tcHV0ZXIucmFuZG9tQXR0YWNrKGh1bWFuKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbaHBvc2l0aW9uPVwiJHtwb3NpdGlvbn1cIl1gKTtcclxuICAgICAgICAgICAgICAgIGxldCB0ZW1wID0gcG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3UG9zaXRpb24gPSBodW1hbi5nYW1lYm9hcmQuY29udmVydFBvc2l0aW9uKHRlbXApO1xyXG4gICAgICAgICAgICAgICAgbGV0IHJvdyA9IGh1bWFuLmdhbWVib2FyZC5nZXRSb3cobmV3UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgbGV0IGNvbCA9IGh1bWFuLmdhbWVib2FyZC5nZXRDb2wobmV3UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGh1bWFuLmdhbWVib2FyZC5ib2FyZFtyb3ddW2NvbF0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbSA9PT0gbnVsbCB8fCBpdGVtID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3NoaXAtaGVyZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpc1N1bmsxID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnJlY2lldmVBdHRhY2soaSwgaik7XHJcbiAgICAgICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnBsYWNlZFNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoaXAubmFtZSA9PT0gaEJvYXJkW3Jvd11bY29sXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTdW5rMSA9IHNoaXAuc3VuaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1N1bmsxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bmtlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vua2VuLnRleHRDb250ZW50ID0gaEJvYXJkW3Jvd11bY29sXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vua2VuMSA9PT0gbnVsbCB8fCBzdW5rZW4xID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdW5rZW4xLmFwcGVuZENoaWxkKHN1bmtlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChodW1hbi5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbm5lci50ZXh0Q29udGVudCA9IFwiV2lubmVyOiBDb21wdXRlciFcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdob1dvbiA9PT0gbnVsbCB8fCB3aG9Xb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdob1dvbi5hcHBlbmRDaGlsZCh3aW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hvV29uID09PSBudWxsIHx8IHdob1dvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogd2hvV29uLmFwcGVuZENoaWxkKHJlc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbSA9PT0gbnVsbCB8fCBpdGVtID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpdGVtLmNsYXNzTGlzdC5hZGQoXCJtaXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZ3JpZDIgPT09IG51bGwgfHwgZ3JpZDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdyaWQyLmFwcGVuZENoaWxkKGdyaWRJdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHBsYWNlU2hpcCBmcm9tIFwiLi9wbGFjZVNoaXBcIjtcclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3RhcnRHYW1lKCkge1xyXG4gICAgY29uc3QgaW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW5mb1wiKTtcclxuICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGlucHV0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpbnB1dC1jb250YWluZXJcIik7XHJcbiAgICBjb25zdCBuYW1lTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgICBuYW1lTGFiZWwudGV4dENvbnRlbnQgPSBcIkVudGVyIE5hbWU6XCI7XHJcbiAgICBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICBuYW1lSW5wdXQuY2xhc3NMaXN0LmFkZChcIm5hbWUtaW5wdXRcIik7XHJcbiAgICBjb25zdCBzdGFydEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICBzdGFydEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwic3RhcnQtYnV0dG9uXCIpO1xyXG4gICAgc3RhcnRCdXR0b24udGV4dENvbnRlbnQgPSBcIlN0YXJ0XCI7XHJcbiAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChuYW1lTGFiZWwpO1xyXG4gICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQobmFtZUlucHV0KTtcclxuICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXJ0QnV0dG9uKTtcclxuICAgIGluZm8gPT09IG51bGwgfHwgaW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5mby5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcik7XHJcbiAgICBzdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChuYW1lSW5wdXQudmFsdWUgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IG5hbWVJbnB1dC52YWx1ZTtcclxuICAgICAgICAgICAgaW5mbyA9PT0gbnVsbCB8fCBpbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmZvLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKTtcclxuICAgICAgICAgICAgcGxhY2VTaGlwKG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IFwiVG8gbGF6eSB0byBlbnRlciBhIG5hbWVcIjtcclxuICAgICAgICAgICAgaW5mbyA9PT0gbnVsbCB8fCBpbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmZvLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKTtcclxuICAgICAgICAgICAgcGxhY2VTaGlwKG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbiIsImltcG9ydCBzdGFydEdhbWUgZnJvbSBcIi4vdWkvc3RhcnRHYW1lXCI7XHJcbnN0YXJ0R2FtZSgpO1xyXG4vLyByZW5kZXJHcmlkcygnampjcmF6eW1hbicpXHJcbiJdLCJuYW1lcyI6WyJHYW1lQm9hcmQiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJib2FyZCIsImNyZWF0ZUJvYXJkIiwiaGl0cyIsIm1pc3NlcyIsInBsYWNlZFNoaXBzIiwiZ2FtZU92ZXIiLCJzdW5rU2hpcHMiLCJjb3VudCIsImkiLCJqIiwicGxhY2VTaGlwIiwic2hpcCIsInN0YXJ0IiwidmVydGljYWwiLCJ2YWxpZFBsYWNlbWVudCIsImxlbmd0aCIsImluY2x1ZGVzIiwiaW5kZXgiLCJpbmRleE9mIiwibmFtZSIsInB1c2giLCJyZWNpZXZlQXR0YWNrIiwicm93IiwiY29sdW1uIiwicG9zaXRpb24iLCJOdW1iZXIiLCJpc0ludGVnZXIiLCJmb3JFYWNoIiwiaGl0IiwiaXNTdW5rIiwiaXNPdmVyIiwiaXNWZXJ0aWNhbCIsIm5ld1Bvc2l0aW9uIiwiY29udmVydFBvc2l0aW9uIiwiZ2V0Um93IiwiZ2V0Q29sIiwicmFuZG9tbHlQbGFjZVNoaXBzIiwiZGlyZWN0aW9uIiwidmFsaWQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzdHIiLCJ0b1N0cmluZyIsInBhcnNlSW50Iiwic2xpY2UiLCJQbGF5ZXIiLCJvcG9uZW50IiwiZ2FtZWJvYXJkIiwic2hvdHMiLCJhdHRhY2siLCJjb2wiLCJyYW5kb21BdHRhY2siLCJvcHBvbmVudCIsInZhbGlkU2hvdCIsImNvbnNvbGUiLCJsb2ciLCJTaGlwIiwiaXNIaXQiLCJzdW5rIiwiaHVtYW4iLCJjb21wdXRlciIsImhCb2FyZCIsImNCb2FyZCIsImhDYXJyaWVyIiwiaERlc3Ryb3llciIsImhTdWJtYXJpbmUiLCJoUGF0cm9sIiwiY0NhcnJpZXIiLCJjRGVzdHJveWVyIiwiY1N1Ym1hcmluZSIsImNQYXRyb2wiLCJodW1hblNoaXBzIiwiY29tcHV0ZXJTaGlwcyIsImNhbGxzIiwicGxheWVyTmFtZSIsImluZm8iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJwbGFjZSIsImdyaWQiLCJzaGlwcyIsInJvdGF0ZUJ1dHRvbiIsImNhcnJpZXIiLCJkZXN0cm95ZXIiLCJzdWJtYXJpbmUiLCJwYXRyb2wiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJzdGFydEJ1dHRvbiIsImlubmVySFRNTCIsIm1haW4iLCJncmlkMSIsInRleHRDb250ZW50Iiwic3Vua2VuMSIsImdyaWQyIiwic3Vua2VuMiIsIndob1dvbiIsInJlc3RhcnQiLCJjcmVhdGVFbGVtZW50IiwibG9jYXRpb24iLCJyZWxvYWQiLCJncmlkSXRlbSIsInNldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwic3Vua2VuIiwid2lubmVyIiwiaXRlbSIsInRlbXAiLCJpc1N1bmsxIiwicmVuZGVyR3JpZHMiLCJjaGVja0JvYXJkIiwicmFuZG9tbHlQbGFjZSIsImRpc2FibGVkIiwicXVlcnlTZWxlY3RvckFsbCIsImRyYWdnYWJsZSIsImV2Iiwic2hpcEVsZW1lbnQiLCJ0YXJnZXQiLCJjdXJyZW50UG9zIiwiZGF0YXNldCIsImhwb3NpdGlvbiIsInNoaXBOYW1lIiwicGxhY2VTaGlwRHJhZ2dlZCIsImlkIiwiZSIsImlucHV0Q29udGFpbmVyIiwibmFtZUxhYmVsIiwibmFtZUlucHV0IiwidmFsdWUiLCJyZW1vdmVDaGlsZCIsInN0YXJ0R2FtZSJdLCJzb3VyY2VSb290IjoiIn0=
=======
(()=>{"use strict";class e{constructor(){this.board=[],this.createBoard(),this.hits=[],this.misses=[],this.placedShips=[],this.gameOver=!1,this.sunkShips=[]}createBoard(){let e=0;for(let t=0;t<10;t++){this.board[t]=[];for(let s=0;s<10;s++)e++,this.board[t][s]=e}}placeShip(e,t,s){if(s&&!0===this.validPlacement(t,e.length,!0)){for(let s=0;s<e.length;s++){for(let s=0;s<this.board.length;s++)if(this.board[s].includes(t)){let n=this.board[s].indexOf(t);this.board[s][n]=e.name}t+=10}this.placedShips.push(e)}else if(!s&&!0===this.validPlacement(t,e.length,!1)){for(let s=0;s<e.length;s++){for(let s=0;s<this.board.length;s++)if(this.board[s].includes(t)){let n=this.board[s].indexOf(t);this.board[s][n]=e.name}t+=1}this.placedShips.push(e)}}recieveAttack(e,t){let s=e+t;Number.isInteger(this.board[e][t])?this.misses.push(s):(this.hits.push(s),this.placedShips.forEach((n=>{if(n.name===this.board[e][t])return n.hit(s),n.isSunk(),void(n.isSunk()&&this.sunkShips.push(n))})))}isOver(){return 4===this.sunkShips.length}validPlacement(e,t,s){let n=this.convertPosition(e),i=this.getRow(n),r=this.getCol(n);if(s&&i+t>10)return!1;if(!s&&r+t>10)return!1;if(s)for(let e=0;e<t;e++){if(!Number.isInteger(this.board[i][r]))return!1;i++}else for(let e=0;e<t;e++){if(!Number.isInteger(this.board[i][r]))return!1;r++}return!0}randomlyPlaceShips(e){let t,s,n=!1;for(;!n;)t=Math.floor(100*Math.random())+1,s=Math.random()<.5,this.validPlacement(t,e.length,s)?(n=!0,this.placeShip(e,t,s)):n=!1}convertPosition(e){let t,s,n=e.toString();return e<11?(t=e-1,s=0):100===e?(s=9,t=9):e%10==0?(s=parseInt(n.slice(0,1)),t=9):(s=parseInt(n.slice(0,1)),t=parseInt(n.slice(1,2))-1),s.toString()+t.toString()}getCol(e){return parseInt(e.slice(1,2))}getRow(e){return parseInt(e.slice(0,1))}}class t{constructor(t,s){this.gameboard=new e,this.name=t,this.shots=[],this.oponent=s}attack(e,t){let s=this.gameboard.convertPosition(e),n=this.gameboard.getRow(s),i=this.gameboard.getCol(s);this.shots.includes(e)||(this.shots.push(e),t.gameboard.recieveAttack(n,i),t.gameboard.isOver())}randomAttack(e){let t,s=!1;for(;!s;){t=Math.floor(100*Math.random())+1;let n=this.gameboard.convertPosition(t),i=this.gameboard.getRow(n),r=this.gameboard.getCol(n);if(!this.shots.includes(t))return this.shots.push(t),e.gameboard.recieveAttack(i,r),s=!0,t}}}class s{constructor(e,t){this.length=e,this.isHit=[],this.sunk=!1,this.name=t}hit(e){if(!this.isHit.includes(e)&&this.isHit.length<this.length)return this.isHit.push(e),this.isHit}isSunk(){return this.isHit.length===this.length&&(this.sunk=!0,!0)}}let n=new t("human","computer"),i=new t("computer","human"),r=n.gameboard.board,a=i.gameboard.board,o=new s(5,"carrier"),l=new s(4,"destroyer"),c=new s(3,"submarine"),d=new s(2,"patrol"),u=new s(5,"carrier"),h=new s(4,"destroyer"),m=new s(3,"submarine"),p=new s(2,"patrol");const g=[o,l,c,d],b=[u,h,m,p];let f=0;function S(e){if(f++,4===[].length)return;let t;const s=document.querySelector(".info");null==s||s.classList.remove("info"),null==s||s.classList.add("hide");const u=document.querySelector(".place");null==u||u.classList.remove("hide");const h=document.querySelector(".grid-container"),m=document.querySelector(".ships"),p=document.querySelector(".rotate"),v=document.querySelector(".carrier"),L=document.querySelector(".destroyer"),y=document.querySelector(".submarine"),C=document.querySelector(".patrol");if(1===f){null==p||p.addEventListener("click",(function(){(null==v?void 0:v.classList.contains("rotated"))?(null==m||m.classList.remove("ships-horizontal"),null==m||m.classList.add("ships-vertical"),v.classList.remove("rotated"),null==L||L.classList.remove("rotated"),null==y||y.classList.remove("rotated"),null==C||C.classList.remove("rotated")):(null==m||m.classList.remove("ships-vertical"),null==m||m.classList.add("ships-horizontal"),null==v||v.classList.add("rotated"),null==L||L.classList.add("rotated"),null==y||y.classList.add("rotated"),null==C||C.classList.add("rotated"))}));const t=document.querySelector(".start-game");null==t||t.addEventListener("click",(function(){u.innerHTML="",function(e){document.querySelector("body"),console.log(r);const t=document.querySelector(".place");null==t||t.classList.add("hide");const s=document.querySelector("#main");s.classList.remove("hide"),s.classList.add("main"),document.querySelector(".content"),document.querySelector(".grid1");const o=document.querySelector(".grid-container1");document.querySelector(".title-1").textContent=e;const l=document.querySelector(".sunken1"),c=(document.querySelector(".grid2"),document.querySelector(".grid-container2"));document.querySelector(".title-2").textContent="Computer";const d=document.querySelector(".sunken2"),u=document.querySelector(".who-won"),h=document.createElement("button");h.classList.add("restart"),h.textContent="Restart",h.addEventListener("click",(function(){location.reload()})),b.forEach((e=>{i.gameboard.randomlyPlaceShips(e)}));let m=0;for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++){m++;const s=document.createElement("div");s.setAttribute("hposition",m),Number.isInteger(r[e][t])||s.classList.add("ship-here"),s.classList.add("grid-item"),null==o||o.appendChild(s)}for(let t=0;t<a.length;t++)for(let s=0;s<a[t].length;s++){const o=document.createElement("div");o.setAttribute("cposition",a[t][s]),o.classList.add("grid-item"),o.classList.add("ai-grid"),o.addEventListener("click",(function(){if(o.classList.contains("hit")||o.classList.contains("miss")||n.gameboard.isOver()||i.gameboard.isOver())return;if(Number.isInteger(a[t][s]))o.classList.add("miss");else{o.classList.add("hit");let n=!1;if(i.gameboard.recieveAttack(t,s),i.gameboard.placedShips.forEach((e=>{e.name===a[t][s]&&(n=e.sunk)})),n){const n=document.createElement("h2");if(n.textContent=a[t][s],null==d||d.appendChild(n),i.gameboard.isOver()){const t=document.createElement("h1");t.textContent="Winner: "+e+"!",null==u||u.appendChild(t),null==u||u.appendChild(h)}}}let c;c=i.randomAttack(n);const m=document.querySelector(`[hposition="${c}"]`);let p=c,g=n.gameboard.convertPosition(p),b=n.gameboard.getRow(g),f=n.gameboard.getCol(g);if(Number.isInteger(n.gameboard.board[b][f]))null==m||m.classList.add("miss");else{null==m||m.classList.remove("ship-here"),null==m||m.classList.add("hit");let e=!1;if(n.gameboard.recieveAttack(t,s),n.gameboard.placedShips.forEach((t=>{t.name===r[b][f]&&(e=t.sunk)})),e){const e=document.createElement("h2");if(e.textContent=r[b][f],null==l||l.appendChild(e),n.gameboard.isOver()){const e=document.createElement("h1");e.textContent="Winner: Computer!",null==u||u.appendChild(e),null==u||u.appendChild(h)}}}})),null==c||c.appendChild(o)}}(e)}))}q();const E=document.querySelector(".randomly-place");function q(){let e=0;h.innerHTML="";for(let t=0;t<r.length;t++)for(let s=0;s<r[t].length;s++){e++;const n=document.createElement("div");n.setAttribute("data-hposition",e),Number.isInteger(r[t][s])||n.classList.add("ship-here"),n.classList.add("grid-item"),null==h||h.appendChild(n)}}null==E||E.addEventListener("click",(function(){g.forEach((e=>{n.gameboard.randomlyPlaceShips(e)})),E.disabled=!0,h.innerHTML="",q()})),document.querySelectorAll(".draggable").forEach((s=>{s.addEventListener("dragstart",(()=>{s.classList.add("dragging")})),s.addEventListener("dragend",(s=>{const i=s.target,r=parseInt(t.dataset.hposition);!function(e,t){"carrier"===e&&(v.classList.contains("rotated")?n.gameboard.placeShip(o,t,!1):n.gameboard.placeShip(o,t,!0)),"destroyer"===e&&(v.classList.contains("rotated")?n.gameboard.placeShip(l,t,!1):n.gameboard.placeShip(l,t,!0)),"submarine"===e&&(v.classList.contains("rotated")?n.gameboard.placeShip(c,t,!1):n.gameboard.placeShip(c,t,!0)),"patrol"===e&&(v.classList.contains("rotated")?n.gameboard.placeShip(d,t,!1):n.gameboard.placeShip(d,t,!0))}(i.id,r),S(e)}))})),document.querySelectorAll(".grid-item").forEach((e=>{e.addEventListener("dragover",(e=>{t=e.target}))}))}!function(){const e=document.querySelector(".info"),t=document.createElement("div");t.classList.add("input-container");const s=document.createElement("label");s.textContent="Enter Name:";const n=document.createElement("input");n.classList.add("name-input");const i=document.createElement("button");i.classList.add("start-button"),i.textContent="Start",t.appendChild(s),t.appendChild(n),t.appendChild(i),null==e||e.appendChild(t),i.addEventListener("click",(function(){if(""!==n.value){const s=n.value;null==e||e.removeChild(t),S(s)}else{const s="To lazy to enter a name";null==e||e.removeChild(t),S(s)}}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZeEQsU0FBUzJCLGNBQWMsU0FDekM2QixFQUFVdEQsVUFBVUUsSUFBSSxjQUN4QixNQUFNVyxFQUFjZixTQUFTMkIsY0FBYyxVQUMzQ1osRUFBWWIsVUFBVUUsSUFBSSxnQkFDMUJXLEVBQVlNLFlBQWMsUUFDMUJpQyxFQUFldEIsWUFBWXVCLEdBQzNCRCxFQUFldEIsWUFBWXdCLEdBQzNCRixFQUFldEIsWUFBWWpCLEdBQzNCaEIsU0FBNENBLEVBQUtpQyxZQUFZc0IsR0FDN0R2QyxFQUFZRixpQkFBaUIsU0FBUyxXQUNsQyxHQUF3QixLQUFwQjJDLEVBQVVDLE1BQWMsQ0FDeEIsTUFBTWpILEVBQU9nSCxFQUFVQyxNQUN2QjFELFNBQTRDQSxFQUFLMkQsWUFBWUosR0FDN0R2SCxFQUFVUyxFQUNkLEtBQ0ssQ0FDRCxNQUFNQSxFQUFPLDBCQUNidUQsU0FBNENBLEVBQUsyRCxZQUFZSixHQUM3RHZILEVBQVVTLEVBQ2QsQ0FDSixHQUNKLENDM0JBbUgsRSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL2dhbWVib2FyZC50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9wbGF5ZXJzLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZmFjdG9yaWVzL3NoaXAudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy91aS9wbGFjZVNoaXAudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy91aS9yZW5kZXJHYW1lQm9hcmRzLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvdWkvc3RhcnRHYW1lLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IHsgU2hpcCB9IGZyb20gJy4vc2hpcCdcclxuZXhwb3J0IGNsYXNzIEdhbWVCb2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmJvYXJkID0gW107XHJcbiAgICAgICAgdGhpcy5jcmVhdGVCb2FyZCgpO1xyXG4gICAgICAgIHRoaXMuaGl0cyA9IFtdO1xyXG4gICAgICAgIHRoaXMubWlzc2VzID0gW107XHJcbiAgICAgICAgdGhpcy5wbGFjZWRTaGlwcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZ2FtZU92ZXIgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnN1bmtTaGlwcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlQm9hcmQoKSB7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtpXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2ldW2pdID0gY291bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwbGFjZVNoaXAoc2hpcCwgc3RhcnQsIHZlcnRpY2FsKSB7XHJcbiAgICAgICAgaWYgKHZlcnRpY2FsICYmIHRoaXMudmFsaWRQbGFjZW1lbnQoc3RhcnQsIHNoaXAubGVuZ3RoLCB0cnVlKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5ib2FyZC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmJvYXJkW2pdLmluY2x1ZGVzKHN0YXJ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmJvYXJkW2pdLmluZGV4T2Yoc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2pdW2luZGV4XSA9IHNoaXAubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzdGFydCArPSAxMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBsYWNlZFNoaXBzLnB1c2goc2hpcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCF2ZXJ0aWNhbCAmJlxyXG4gICAgICAgICAgICB0aGlzLnZhbGlkUGxhY2VtZW50KHN0YXJ0LCBzaGlwLmxlbmd0aCwgZmFsc2UpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmJvYXJkLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRbal0uaW5jbHVkZXMoc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMuYm9hcmRbal0uaW5kZXhPZihzdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbal1baW5kZXhdID0gc2hpcC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXJ0ICs9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wbGFjZWRTaGlwcy5wdXNoKHNoaXApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJlY2lldmVBdHRhY2socm93LCBjb2x1bW4pIHtcclxuICAgICAgICBsZXQgcG9zaXRpb24gPSByb3cgKyBjb2x1bW47XHJcbiAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHRoaXMuYm9hcmRbcm93XVtjb2x1bW5dKSkge1xyXG4gICAgICAgICAgICB0aGlzLmhpdHMucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VkU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNoaXAubmFtZSA9PT0gdGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzaGlwLmhpdChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcC5pc1N1bmsoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN1bmtTaGlwcy5wdXNoKHNoaXApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5taXNzZXMucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpc092ZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3Vua1NoaXBzLmxlbmd0aCA9PT0gNCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdmFsaWRQbGFjZW1lbnQocG9zaXRpb24sIGxlbmd0aCwgaXNWZXJ0aWNhbCkge1xyXG4gICAgICAgIGxldCBuZXdQb3NpdGlvbiA9IHRoaXMuY29udmVydFBvc2l0aW9uKHBvc2l0aW9uKTtcclxuICAgICAgICBsZXQgcm93ID0gdGhpcy5nZXRSb3cobmV3UG9zaXRpb24pO1xyXG4gICAgICAgIGxldCBjb2x1bW4gPSB0aGlzLmdldENvbChuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgaWYgKGlzVmVydGljYWwgJiYgcm93ICsgbGVuZ3RoID4gMTApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghaXNWZXJ0aWNhbCAmJiBjb2x1bW4gKyBsZW5ndGggPiAxMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1ZlcnRpY2FsKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcih0aGlzLmJvYXJkW3Jvd11bY29sdW1uXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByb3crKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHRoaXMuYm9hcmRbcm93XVtjb2x1bW5dKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbisrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApIHtcclxuICAgICAgICBsZXQgdmFsaWQgPSBmYWxzZTtcclxuICAgICAgICBsZXQgcG9zaXRpb247XHJcbiAgICAgICAgbGV0IGRpcmVjdGlvbjtcclxuICAgICAgICB3aGlsZSAoIXZhbGlkKSB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArIDE7XHJcbiAgICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC41KSB7XHJcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRQbGFjZW1lbnQocG9zaXRpb24sIHNoaXAubGVuZ3RoLCBkaXJlY3Rpb24pKSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYWNlU2hpcChzaGlwLCBwb3NpdGlvbiwgZGlyZWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIC8vIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnZlcnRQb3NpdGlvbihwb3NpdGlvbikge1xyXG4gICAgICAgIGxldCBjb2x1bW47XHJcbiAgICAgICAgbGV0IHN0ciA9IHBvc2l0aW9uLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IHJvdztcclxuICAgICAgICBpZiAocG9zaXRpb24gPCAxMSkge1xyXG4gICAgICAgICAgICBjb2x1bW4gPSBwb3NpdGlvbiAtIDE7XHJcbiAgICAgICAgICAgIHJvdyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvc2l0aW9uID09PSAxMDApIHtcclxuICAgICAgICAgICAgcm93ID0gOTtcclxuICAgICAgICAgICAgY29sdW1uID0gOTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocG9zaXRpb24gJSAxMCA9PT0gMCkge1xyXG4gICAgICAgICAgICByb3cgPSBwYXJzZUludChzdHIuc2xpY2UoMCwgMSkpO1xyXG4gICAgICAgICAgICBjb2x1bW4gPSA5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcm93ID0gcGFyc2VJbnQoc3RyLnNsaWNlKDAsIDEpKTtcclxuICAgICAgICAgICAgY29sdW1uID0gcGFyc2VJbnQoc3RyLnNsaWNlKDEsIDIpKSAtIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBzdHJSb3cgPSByb3cudG9TdHJpbmcoKTtcclxuICAgICAgICBsZXQgc3RyQ29sID0gY29sdW1uLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gc3RyUm93ICsgc3RyQ29sO1xyXG4gICAgICAgIHJldHVybiBuZXdQb3NpdGlvbjtcclxuICAgIH1cclxuICAgIGdldENvbChzdHIpIHtcclxuICAgICAgICByZXR1cm4gcGFyc2VJbnQoc3RyLnNsaWNlKDEsIDIpKTtcclxuICAgIH1cclxuICAgIGdldFJvdyhzdHIpIHtcclxuICAgICAgICByZXR1cm4gcGFyc2VJbnQoc3RyLnNsaWNlKDAsIDEpKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcclxuZXhwb3J0IGNsYXNzIFBsYXllciB7XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lLCBvcG9uZW50KSB7XHJcbiAgICAgICAgdGhpcy5nYW1lYm9hcmQgPSBuZXcgR2FtZUJvYXJkKCk7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLnNob3RzID0gW107XHJcbiAgICAgICAgdGhpcy5vcG9uZW50ID0gb3BvbmVudDtcclxuICAgIH1cclxuICAgIGF0dGFjayhwb3NpdGlvbiwgb3BvbmVudCkge1xyXG4gICAgICAgIGxldCBuZXdQb3NpdGlvbiA9IHRoaXMuZ2FtZWJvYXJkLmNvbnZlcnRQb3NpdGlvbihwb3NpdGlvbik7XHJcbiAgICAgICAgbGV0IHJvdyA9IHRoaXMuZ2FtZWJvYXJkLmdldFJvdyhuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgbGV0IGNvbCA9IHRoaXMuZ2FtZWJvYXJkLmdldENvbChuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNob3RzLmluY2x1ZGVzKHBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3RzLnB1c2gocG9zaXRpb24pO1xyXG4gICAgICAgICAgICBvcG9uZW50LmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKHJvdywgY29sKTtcclxuICAgICAgICAgICAgaWYgKG9wb25lbnQuZ2FtZWJvYXJkLmlzT3ZlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImdnXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByYW5kb21BdHRhY2sob3Bwb25lbnQpIHtcclxuICAgICAgICBsZXQgdmFsaWRTaG90ID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHBvc2l0aW9uO1xyXG4gICAgICAgIHdoaWxlICghdmFsaWRTaG90KSB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArIDE7XHJcbiAgICAgICAgICAgIGxldCBuZXdQb3NpdGlvbiA9IHRoaXMuZ2FtZWJvYXJkLmNvbnZlcnRQb3NpdGlvbihwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIGxldCByb3cgPSB0aGlzLmdhbWVib2FyZC5nZXRSb3cobmV3UG9zaXRpb24pO1xyXG4gICAgICAgICAgICBsZXQgY29sID0gdGhpcy5nYW1lYm9hcmQuZ2V0Q29sKG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNob3RzLmluY2x1ZGVzKHBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG90cy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIG9wcG9uZW50LmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKHJvdywgY29sKTtcclxuICAgICAgICAgICAgICAgIHZhbGlkU2hvdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyBsZXQgc3RyOiBzdHJpbmdcclxuICAgICAgICAgICAgICAgIC8vIHN0ciA9IHJvdy50b1N0cmluZygpICsgY29sLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgU2hpcCB7XHJcbiAgICBjb25zdHJ1Y3RvcihsZW5ndGgsIG5hbWUpIHtcclxuICAgICAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcclxuICAgICAgICB0aGlzLmlzSGl0ID0gW107XHJcbiAgICAgICAgdGhpcy5zdW5rID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxuICAgIGhpdChwb3NpdGlvbikge1xyXG4gICAgICAgIC8vcHVzaCBwb3NpdGlvbiB0byBpc2hpdCBhcnJheVxyXG4gICAgICAgIGlmICghdGhpcy5pc0hpdC5pbmNsdWRlcyhwb3NpdGlvbikgJiYgdGhpcy5pc0hpdC5sZW5ndGggPCB0aGlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmlzSGl0LnB1c2gocG9zaXRpb24pO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc0hpdDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpc1N1bmsoKSB7XHJcbiAgICAgICAgLy9jaGVja3MgZWFjaCBwb3NpdGlvbiBvZiBzaGlwIGZvciBoaXRzIGlmIGFsbCBhcmUgaGl0IGlzIHN1bmtcclxuICAgICAgICBpZiAodGhpcy5pc0hpdC5sZW5ndGggPT09IHRoaXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VuayA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHJlbmRlckdyaWRzIGZyb20gXCIuL3JlbmRlckdhbWVCb2FyZHNcIjtcclxuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vLi4vZmFjdG9yaWVzL3BsYXllcnNcIjtcclxuaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuLy4uL2ZhY3Rvcmllcy9zaGlwXCI7XHJcbmxldCBodW1hbiA9IG5ldyBQbGF5ZXIoXCJodW1hblwiLCBcImNvbXB1dGVyXCIpO1xyXG5sZXQgY29tcHV0ZXIgPSBuZXcgUGxheWVyKFwiY29tcHV0ZXJcIiwgXCJodW1hblwiKTtcclxubGV0IGhCb2FyZCA9IGh1bWFuLmdhbWVib2FyZC5ib2FyZDtcclxubGV0IGNCb2FyZCA9IGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZDtcclxubGV0IGhDYXJyaWVyID0gbmV3IFNoaXAoNSwgXCJjYXJyaWVyXCIpO1xyXG5sZXQgaERlc3Ryb3llciA9IG5ldyBTaGlwKDQsIFwiZGVzdHJveWVyXCIpO1xyXG5sZXQgaFN1Ym1hcmluZSA9IG5ldyBTaGlwKDMsIFwic3VibWFyaW5lXCIpO1xyXG5sZXQgaFBhdHJvbCA9IG5ldyBTaGlwKDIsIFwicGF0cm9sXCIpO1xyXG5sZXQgY0NhcnJpZXIgPSBuZXcgU2hpcCg1LCBcImNhcnJpZXJcIik7XHJcbmxldCBjRGVzdHJveWVyID0gbmV3IFNoaXAoNCwgXCJkZXN0cm95ZXJcIik7XHJcbmxldCBjU3VibWFyaW5lID0gbmV3IFNoaXAoMywgXCJzdWJtYXJpbmVcIik7XHJcbmxldCBjUGF0cm9sID0gbmV3IFNoaXAoMiwgXCJwYXRyb2xcIik7XHJcbmNvbnN0IGh1bWFuU2hpcHMgPSBbaENhcnJpZXIsIGhEZXN0cm95ZXIsIGhTdWJtYXJpbmUsIGhQYXRyb2xdO1xyXG5jb25zdCBjb21wdXRlclNoaXBzID0gW2NDYXJyaWVyLCBjRGVzdHJveWVyLCBjU3VibWFyaW5lLCBjUGF0cm9sXTtcclxubGV0IGNhbGxzID0gMDtcclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcGxhY2VTaGlwKHBsYXllck5hbWUpIHtcclxuICAgIGNhbGxzKys7XHJcbiAgICBjb25zdCBtYW51YWxseVBsYWNlZFNoaXBzID0gW107XHJcbiAgICBpZiAobWFudWFsbHlQbGFjZWRTaGlwcy5sZW5ndGggPT09IDQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgcG9zaXRpb247XHJcbiAgICBjb25zdCBpbmZvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmZvXCIpO1xyXG4gICAgaW5mbyA9PT0gbnVsbCB8fCBpbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmZvLmNsYXNzTGlzdC5yZW1vdmUoXCJpbmZvXCIpO1xyXG4gICAgaW5mbyA9PT0gbnVsbCB8fCBpbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmZvLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xyXG4gICAgY29uc3QgcGxhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlXCIpO1xyXG4gICAgcGxhY2UgPT09IG51bGwgfHwgcGxhY2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBsYWNlLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xyXG4gICAgY29uc3QgZ3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ3JpZC1jb250YWluZXJcIik7XHJcbiAgICBjb25zdCBzaGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hpcHNcIik7XHJcbiAgICBjb25zdCByb3RhdGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJvdGF0ZVwiKTtcclxuICAgIGNvbnN0IGNhcnJpZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcnJpZXJcIik7XHJcbiAgICBjb25zdCBkZXN0cm95ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlc3Ryb3llclwiKTtcclxuICAgIGNvbnN0IHN1Ym1hcmluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3VibWFyaW5lXCIpO1xyXG4gICAgY29uc3QgcGF0cm9sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wYXRyb2xcIik7XHJcbiAgICBpZiAoY2FsbHMgPT09IDEpIHtcclxuICAgICAgICByb3RhdGVCdXR0b24gPT09IG51bGwgfHwgcm90YXRlQnV0dG9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiByb3RhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGNhcnJpZXIgPT09IG51bGwgfHwgY2FycmllciA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2Fycmllci5jbGFzc0xpc3QuY29udGFpbnMoXCJyb3RhdGVkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBzaGlwcyA9PT0gbnVsbCB8fCBzaGlwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2hpcHMuY2xhc3NMaXN0LnJlbW92ZShcInNoaXBzLWhvcml6b250YWxcIik7XHJcbiAgICAgICAgICAgICAgICBzaGlwcyA9PT0gbnVsbCB8fCBzaGlwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2hpcHMuY2xhc3NMaXN0LmFkZChcInNoaXBzLXZlcnRpY2FsXCIpO1xyXG4gICAgICAgICAgICAgICAgY2Fycmllci5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIGRlc3Ryb3llciA9PT0gbnVsbCB8fCBkZXN0cm95ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRlc3Ryb3llci5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIHN1Ym1hcmluZSA9PT0gbnVsbCB8fCBzdWJtYXJpbmUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN1Ym1hcmluZS5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgICAgIHBhdHJvbCA9PT0gbnVsbCB8fCBwYXRyb2wgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhdHJvbC5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNoaXBzID09PSBudWxsIHx8IHNoaXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaGlwcy5jbGFzc0xpc3QucmVtb3ZlKFwic2hpcHMtdmVydGljYWxcIik7XHJcbiAgICAgICAgICAgICAgICBzaGlwcyA9PT0gbnVsbCB8fCBzaGlwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2hpcHMuY2xhc3NMaXN0LmFkZChcInNoaXBzLWhvcml6b250YWxcIik7XHJcbiAgICAgICAgICAgICAgICBjYXJyaWVyID09PSBudWxsIHx8IGNhcnJpZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNhcnJpZXIuY2xhc3NMaXN0LmFkZChcInJvdGF0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICBkZXN0cm95ZXIgPT09IG51bGwgfHwgZGVzdHJveWVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkZXN0cm95ZXIuY2xhc3NMaXN0LmFkZChcInJvdGF0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICBzdWJtYXJpbmUgPT09IG51bGwgfHwgc3VibWFyaW5lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdWJtYXJpbmUuY2xhc3NMaXN0LmFkZChcInJvdGF0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICBwYXRyb2wgPT09IG51bGwgfHwgcGF0cm9sID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwYXRyb2wuY2xhc3NMaXN0LmFkZChcInJvdGF0ZWRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBzdGFydEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3RhcnQtZ2FtZVwiKTtcclxuICAgICAgICBzdGFydEJ1dHRvbiA9PT0gbnVsbCB8fCBzdGFydEJ1dHRvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcGxhY2UuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgICAgIHJlbmRlckdyaWRzKHBsYXllck5hbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY2hlY2tCb2FyZCgpO1xyXG4gICAgY29uc3QgcmFuZG9tbHlQbGFjZSA9IChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJhbmRvbWx5LXBsYWNlXCIpKTtcclxuICAgIHJhbmRvbWx5UGxhY2UgPT09IG51bGwgfHwgcmFuZG9tbHlQbGFjZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmFuZG9tbHlQbGFjZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGh1bWFuU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJhbmRvbWx5UGxhY2UuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGdyaWQuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICBjaGVja0JvYXJkKCk7XHJcbiAgICB9KTtcclxuICAgIGZ1bmN0aW9uIGNoZWNrQm9hcmQoKSB7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICBncmlkLmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaEJvYXJkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaEJvYXJkW2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAgICAgZ3JpZEl0ZW0uc2V0QXR0cmlidXRlKFwiZGF0YS1ocG9zaXRpb25cIiwgY291bnQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGhCb2FyZFtpXVtqXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwic2hpcC1oZXJlXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcImdyaWQtaXRlbVwiKTtcclxuICAgICAgICAgICAgICAgIGdyaWQgPT09IG51bGwgfHwgZ3JpZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ3JpZC5hcHBlbmRDaGlsZChncmlkSXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBldmVudHMoKTtcclxuICAgIGZ1bmN0aW9uIGV2ZW50cygpIHtcclxuICAgICAgICBjb25zdCBkcmFnZ2FibGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5kcmFnZ2FibGVcIik7XHJcbiAgICAgICAgZHJhZ2dhYmxlcy5mb3JFYWNoKChkcmFnZ2FibGUpID0+IHtcclxuICAgICAgICAgICAgZHJhZ2dhYmxlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZHJhZ2dhYmxlLmNsYXNzTGlzdC5hZGQoJ2RyYWdnaW5nJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdlbmRcIiwgKGV2KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzaGlwRWxlbWVudCA9IGV2LnRhcmdldDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQb3MgPSBwYXJzZUludChwb3NpdGlvbi5kYXRhc2V0Lmhwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzaGlwTmFtZSA9IHNoaXBFbGVtZW50LmlkO1xyXG4gICAgICAgICAgICAgICAgcGxhY2VTaGlwRHJhZ2dlZChzaGlwTmFtZSwgY3VycmVudFBvcyk7XHJcbiAgICAgICAgICAgICAgICBwbGFjZVNoaXAocGxheWVyTmFtZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IGdyaWRJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5ncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgZ3JpZEl0ZW0uZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gZS50YXJnZXQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy8gZnVuY3Rpb24gaXNWYWxpZChwb3NpdGlvbjogbnVtYmVyLCBuYW1lOiBzdHJpbmcpe1xyXG4gICAgLy8gICBsZXQgZGlyZWN0aW9uID0gZmFsc2U7XHJcbiAgICAvLyAgIGlmKGNhcnJpZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwicm90YXRlZFwiKSl7XHJcbiAgICAvLyAgICAgZGlyZWN0aW9uID0gdHJ1ZTtcclxuICAgIC8vICAgfVxyXG4gICAgLy8gICBpZihuYW1lID09PSBcImNhcnJpZXJcIil7XHJcbiAgICAvLyAgICAgaHVtYW4uZ2FtZWJvYXJkLnZhbGlkUGxhY2VtZW50KHBvc2l0aW9uLCA1LCBkaXJlY3Rpb24pXHJcbiAgICAvLyAgIH1cclxuICAgIC8vIH1cclxuICAgIGZ1bmN0aW9uIHBsYWNlU2hpcERyYWdnZWQoc2hpcE5hbWUsIGN1cnJlbnRQb3MpIHtcclxuICAgICAgICBpZiAoc2hpcE5hbWUgPT09IFwiY2FycmllclwiKSB7XHJcbiAgICAgICAgICAgIGlmIChjYXJyaWVyLmNsYXNzTGlzdC5jb250YWlucyhcInJvdGF0ZWRcIikpIHtcclxuICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoaENhcnJpZXIsIGN1cnJlbnRQb3MsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoaENhcnJpZXIsIGN1cnJlbnRQb3MsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGlwTmFtZSA9PT0gXCJkZXN0cm95ZXJcIikge1xyXG4gICAgICAgICAgICBpZiAoY2Fycmllci5jbGFzc0xpc3QuY29udGFpbnMoXCJyb3RhdGVkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhEZXN0cm95ZXIsIGN1cnJlbnRQb3MsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoaERlc3Ryb3llciwgY3VycmVudFBvcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNoaXBOYW1lID09PSBcInN1Ym1hcmluZVwiKSB7XHJcbiAgICAgICAgICAgIGlmIChjYXJyaWVyLmNsYXNzTGlzdC5jb250YWlucyhcInJvdGF0ZWRcIikpIHtcclxuICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoaFN1Ym1hcmluZSwgY3VycmVudFBvcywgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcChoU3VibWFyaW5lLCBjdXJyZW50UG9zLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2hpcE5hbWUgPT09IFwicGF0cm9sXCIpIHtcclxuICAgICAgICAgICAgaWYgKGNhcnJpZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwicm90YXRlZFwiKSkge1xyXG4gICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcChoUGF0cm9sLCBjdXJyZW50UG9zLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhQYXRyb2wsIGN1cnJlbnRQb3MsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmV4cG9ydCB7IGh1bWFuU2hpcHMsIGNvbXB1dGVyU2hpcHMsIGh1bWFuLCBjb21wdXRlciwgaEJvYXJkLCBjQm9hcmQgfTtcclxuIiwiaW1wb3J0IHsgY29tcHV0ZXJTaGlwcywgaHVtYW4sIGNvbXB1dGVyLCBoQm9hcmQsIGNCb2FyZCB9IGZyb20gXCIuLi91aS9wbGFjZVNoaXBcIjtcclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcmVuZGVyR3JpZHMocGxheWVyTmFtZSkge1xyXG4gICAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpO1xyXG4gICAgY29uc29sZS5sb2coaEJvYXJkKTtcclxuICAgIC8vIGNvbnN0IGluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIik7XHJcbiAgICAvLyBpbmZvPy5jbGFzc0xpc3QucmVtb3ZlKFwiaW5mb1wiKTtcclxuICAgIC8vIGluZm8/LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xyXG4gICAgY29uc3QgcGxhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2UnKTtcclxuICAgIHBsYWNlID09PSBudWxsIHx8IHBsYWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbGFjZS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtYWluXCIpO1xyXG4gICAgbWFpbi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcclxuICAgIG1haW4uY2xhc3NMaXN0LmFkZChcIm1haW5cIik7XHJcbiAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250ZW50XCIpO1xyXG4gICAgY29uc3QgZ3JpZENvbnRhaW5lcjEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQxXCIpO1xyXG4gICAgY29uc3QgZ3JpZDEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQtY29udGFpbmVyMVwiKTtcclxuICAgIGNvbnN0IHRpdGxlMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGUtMVwiKTtcclxuICAgIHRpdGxlMS50ZXh0Q29udGVudCA9IHBsYXllck5hbWU7XHJcbiAgICBjb25zdCBzdW5rZW4xID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdW5rZW4xXCIpO1xyXG4gICAgY29uc3QgZ3JpZENvbnRhaW5lcjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQyXCIpO1xyXG4gICAgY29uc3QgZ3JpZDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQtY29udGFpbmVyMlwiKTtcclxuICAgIGNvbnN0IHRpdGxlMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGUtMlwiKTtcclxuICAgIHRpdGxlMi50ZXh0Q29udGVudCA9IFwiQ29tcHV0ZXJcIjtcclxuICAgIGNvbnN0IHN1bmtlbjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN1bmtlbjJcIik7XHJcbiAgICBjb25zdCB3aG9Xb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndoby13b25cIik7XHJcbiAgICBjb25zdCByZXN0YXJ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuICAgIHJlc3RhcnQuY2xhc3NMaXN0LmFkZChcInJlc3RhcnRcIik7XHJcbiAgICByZXN0YXJ0LnRleHRDb250ZW50ID0gXCJSZXN0YXJ0XCI7XHJcbiAgICByZXN0YXJ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICB9KTtcclxuICAgIC8vIGxldCBodW1hbiA9IG5ldyBQbGF5ZXIoXCJodW1hblwiLCBcImNvbXB1dGVyXCIpO1xyXG4gICAgLy8gbGV0IGNvbXB1dGVyID0gbmV3IFBsYXllcihcImNvbXB1dGVyXCIsIFwiaHVtYW5cIik7XHJcbiAgICAvLyBsZXQgaEJvYXJkID0gaHVtYW4uZ2FtZWJvYXJkLmJvYXJkO1xyXG4gICAgLy8gbGV0IGNCb2FyZCA9IGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZDtcclxuICAgIC8vIGxldCBoQ2FycmllciA9IG5ldyBTaGlwKDUsIFwiY2FycmllclwiKTtcclxuICAgIC8vIGxldCBoRGVzdHJveWVyID0gbmV3IFNoaXAoNCwgXCJkZXN0cm95ZXJcIik7XHJcbiAgICAvLyBsZXQgaFN1Ym1hcmluZSA9IG5ldyBTaGlwKDMsIFwic3VibWFyaW5lXCIpO1xyXG4gICAgLy8gbGV0IGhQYXRyb2wgPSBuZXcgU2hpcCgyLCBcInBhdHJvbFwiKTtcclxuICAgIC8vIGxldCBjQ2FycmllciA9IG5ldyBTaGlwKDUsIFwiY2FycmllclwiKTtcclxuICAgIC8vIGxldCBjRGVzdHJveWVyID0gbmV3IFNoaXAoNCwgXCJkZXN0cm95ZXJcIik7XHJcbiAgICAvLyBsZXQgY1N1Ym1hcmluZSA9IG5ldyBTaGlwKDMsIFwic3VibWFyaW5lXCIpO1xyXG4gICAgLy8gbGV0IGNQYXRyb2wgPSBuZXcgU2hpcCgyLCBcInBhdHJvbFwiKTtcclxuICAgIC8vIGNvbnN0IGh1bWFuU2hpcHMgPSBbaENhcnJpZXIsIGhEZXN0cm95ZXIsIGhTdWJtYXJpbmUsIGhQYXRyb2xdO1xyXG4gICAgLy8gY29uc3QgY29tcHV0ZXJTaGlwcyA9IFtjQ2FycmllciwgY0Rlc3Ryb3llciwgY1N1Ym1hcmluZSwgY1BhdHJvbF07XHJcbiAgICAvLyBhbGxTaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgLy8gICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICAvLyAgICAgaHVtYW4uZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIC8vIH0pXHJcbiAgICBjb21wdXRlclNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcclxuICAgICAgICBjb21wdXRlci5nYW1lYm9hcmQucmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApO1xyXG4gICAgfSk7XHJcbiAgICAvLyBodW1hblNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcclxuICAgIC8vICAgaHVtYW4uZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIC8vIH0pO1xyXG4gICAgbGV0IGNvdW50ID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaEJvYXJkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBoQm9hcmRbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5zZXRBdHRyaWJ1dGUoXCJocG9zaXRpb25cIiwgY291bnQpO1xyXG4gICAgICAgICAgICAvLyBncmlkSXRlbS50ZXh0Q29udGVudCA9IGJvYXJkW2ldW2pdXHJcbiAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihoQm9hcmRbaV1bal0pKSB7XHJcbiAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwic2hpcC1oZXJlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgICAgIGdyaWQxID09PSBudWxsIHx8IGdyaWQxID09PSB2b2lkIDAgPyB2b2lkIDAgOiBncmlkMS5hcHBlbmRDaGlsZChncmlkSXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjQm9hcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNCb2FyZFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBjb25zdCBncmlkSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLnNldEF0dHJpYnV0ZShcImNwb3NpdGlvblwiLCBjQm9hcmRbaV1bal0pO1xyXG4gICAgICAgICAgICAvLyBncmlkSXRlbS50ZXh0Q29udGVudCA9IGJvYXJkW2ldW2pdXHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJhaS1ncmlkXCIpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGdyaWRJdGVtLmNsYXNzTGlzdC5jb250YWlucyhcImhpdFwiKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5jb250YWlucyhcIm1pc3NcIikgfHxcclxuICAgICAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQuaXNPdmVyKCkgfHxcclxuICAgICAgICAgICAgICAgICAgICBjb21wdXRlci5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoY0JvYXJkW2ldW2pdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlzU3VuayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKGksIGopO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5wbGFjZWRTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLm5hbWUgPT09IGNCb2FyZFtpXVtqXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTdW5rID0gc2hpcC5zdW5rO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzU3Vuaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW5rZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbi50ZXh0Q29udGVudCA9IGNCb2FyZFtpXVtqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vua2VuMiA9PT0gbnVsbCB8fCBzdW5rZW4yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdW5rZW4yLmFwcGVuZENoaWxkKHN1bmtlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wdXRlci5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbm5lci50ZXh0Q29udGVudCA9IFwiV2lubmVyOiBcIiArIHBsYXllck5hbWUgKyBcIiFcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdob1dvbiA9PT0gbnVsbCB8fCB3aG9Xb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdob1dvbi5hcHBlbmRDaGlsZCh3aW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hvV29uID09PSBudWxsIHx8IHdob1dvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogd2hvV29uLmFwcGVuZENoaWxkKHJlc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgcG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGNvbXB1dGVyLnJhbmRvbUF0dGFjayhodW1hbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2hwb3NpdGlvbj1cIiR7cG9zaXRpb259XCJdYCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gaHVtYW4uZ2FtZWJvYXJkLmNvbnZlcnRQb3NpdGlvbih0ZW1wKTtcclxuICAgICAgICAgICAgICAgIGxldCByb3cgPSBodW1hbi5nYW1lYm9hcmQuZ2V0Um93KG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGxldCBjb2wgPSBodW1hbi5nYW1lYm9hcmQuZ2V0Q29sKG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihodW1hbi5nYW1lYm9hcmQuYm9hcmRbcm93XVtjb2xdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdzaGlwLWhlcmUnKTtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtID09PSBudWxsIHx8IGl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGl0ZW0uY2xhc3NMaXN0LmFkZChcImhpdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaXNTdW5rMSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKGksIGopO1xyXG4gICAgICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZWRTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLm5hbWUgPT09IGhCb2FyZFtyb3ddW2NvbF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU3VuazEgPSBzaGlwLnN1bms7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdW5rMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW5rZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbi50ZXh0Q29udGVudCA9IGhCb2FyZFtyb3ddW2NvbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbjEgPT09IG51bGwgfHwgc3Vua2VuMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3Vua2VuMS5hcHBlbmRDaGlsZChzdW5rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHVtYW4uZ2FtZWJvYXJkLmlzT3ZlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3aW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBcIldpbm5lcjogQ29tcHV0ZXIhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aG9Xb24gPT09IG51bGwgfHwgd2hvV29uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB3aG9Xb24uYXBwZW5kQ2hpbGQod2lubmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdob1dvbiA9PT0gbnVsbCB8fCB3aG9Xb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdob1dvbi5hcHBlbmRDaGlsZChyZXN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGdyaWQyID09PSBudWxsIHx8IGdyaWQyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBncmlkMi5hcHBlbmRDaGlsZChncmlkSXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBwbGFjZVNoaXAgZnJvbSBcIi4vcGxhY2VTaGlwXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHN0YXJ0R2FtZSgpIHtcclxuICAgIGNvbnN0IGluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIik7XHJcbiAgICBjb25zdCBpbnB1dENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBpbnB1dENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaW5wdXQtY29udGFpbmVyXCIpO1xyXG4gICAgY29uc3QgbmFtZUxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgbmFtZUxhYmVsLnRleHRDb250ZW50ID0gXCJFbnRlciBOYW1lOlwiO1xyXG4gICAgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgbmFtZUlucHV0LmNsYXNzTGlzdC5hZGQoXCJuYW1lLWlucHV0XCIpO1xyXG4gICAgY29uc3Qgc3RhcnRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgc3RhcnRCdXR0b24uY2xhc3NMaXN0LmFkZChcInN0YXJ0LWJ1dHRvblwiKTtcclxuICAgIHN0YXJ0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTdGFydFwiO1xyXG4gICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQobmFtZUxhYmVsKTtcclxuICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKG5hbWVJbnB1dCk7XHJcbiAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChzdGFydEJ1dHRvbik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uYXBwZW5kQ2hpbGQoaW5wdXRDb250YWluZXIpO1xyXG4gICAgc3RhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAobmFtZUlucHV0LnZhbHVlICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBuYW1lSW5wdXQudmFsdWU7XHJcbiAgICAgICAgICAgIGluZm8gPT09IG51bGwgfHwgaW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5mby5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIHBsYWNlU2hpcChuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBcIlRvIGxhenkgdG8gZW50ZXIgYSBuYW1lXCI7XHJcbiAgICAgICAgICAgIGluZm8gPT09IG51bGwgfHwgaW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5mby5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIHBsYWNlU2hpcChuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4iLCJpbXBvcnQgc3RhcnRHYW1lIGZyb20gXCIuL3VpL3N0YXJ0R2FtZVwiO1xyXG5zdGFydEdhbWUoKTtcclxuLy8gcmVuZGVyR3JpZHMoJ2pqY3JhenltYW4nKVxyXG4iXSwibmFtZXMiOlsiR2FtZUJvYXJkIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiYm9hcmQiLCJjcmVhdGVCb2FyZCIsImhpdHMiLCJtaXNzZXMiLCJwbGFjZWRTaGlwcyIsImdhbWVPdmVyIiwic3Vua1NoaXBzIiwiY291bnQiLCJpIiwiaiIsInBsYWNlU2hpcCIsInNoaXAiLCJzdGFydCIsInZlcnRpY2FsIiwidmFsaWRQbGFjZW1lbnQiLCJsZW5ndGgiLCJpbmNsdWRlcyIsImluZGV4IiwiaW5kZXhPZiIsIm5hbWUiLCJwdXNoIiwicmVjaWV2ZUF0dGFjayIsInJvdyIsImNvbHVtbiIsInBvc2l0aW9uIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiZm9yRWFjaCIsImhpdCIsImlzU3VuayIsImlzT3ZlciIsImlzVmVydGljYWwiLCJuZXdQb3NpdGlvbiIsImNvbnZlcnRQb3NpdGlvbiIsImdldFJvdyIsImdldENvbCIsInJhbmRvbWx5UGxhY2VTaGlwcyIsImRpcmVjdGlvbiIsInZhbGlkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic3RyIiwidG9TdHJpbmciLCJwYXJzZUludCIsInNsaWNlIiwiUGxheWVyIiwib3BvbmVudCIsImdhbWVib2FyZCIsInNob3RzIiwiYXR0YWNrIiwiY29sIiwicmFuZG9tQXR0YWNrIiwib3Bwb25lbnQiLCJ2YWxpZFNob3QiLCJTaGlwIiwiaXNIaXQiLCJzdW5rIiwiaHVtYW4iLCJjb21wdXRlciIsImhCb2FyZCIsImNCb2FyZCIsImhDYXJyaWVyIiwiaERlc3Ryb3llciIsImhTdWJtYXJpbmUiLCJoUGF0cm9sIiwiY0NhcnJpZXIiLCJjRGVzdHJveWVyIiwiY1N1Ym1hcmluZSIsImNQYXRyb2wiLCJodW1hblNoaXBzIiwiY29tcHV0ZXJTaGlwcyIsImNhbGxzIiwicGxheWVyTmFtZSIsImluZm8iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJwbGFjZSIsImdyaWQiLCJzaGlwcyIsInJvdGF0ZUJ1dHRvbiIsImNhcnJpZXIiLCJkZXN0cm95ZXIiLCJzdWJtYXJpbmUiLCJwYXRyb2wiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJzdGFydEJ1dHRvbiIsImlubmVySFRNTCIsImNvbnNvbGUiLCJsb2ciLCJtYWluIiwiZ3JpZDEiLCJ0ZXh0Q29udGVudCIsInN1bmtlbjEiLCJncmlkMiIsInN1bmtlbjIiLCJ3aG9Xb24iLCJyZXN0YXJ0IiwiY3JlYXRlRWxlbWVudCIsImxvY2F0aW9uIiwicmVsb2FkIiwiZ3JpZEl0ZW0iLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsInN1bmtlbiIsIndpbm5lciIsIml0ZW0iLCJ0ZW1wIiwiaXNTdW5rMSIsInJlbmRlckdyaWRzIiwiY2hlY2tCb2FyZCIsInJhbmRvbWx5UGxhY2UiLCJkaXNhYmxlZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkcmFnZ2FibGUiLCJldiIsInNoaXBFbGVtZW50IiwidGFyZ2V0IiwiY3VycmVudFBvcyIsImRhdGFzZXQiLCJocG9zaXRpb24iLCJzaGlwTmFtZSIsInBsYWNlU2hpcERyYWdnZWQiLCJpZCIsImUiLCJpbnB1dENvbnRhaW5lciIsIm5hbWVMYWJlbCIsIm5hbWVJbnB1dCIsInZhbHVlIiwicmVtb3ZlQ2hpbGQiLCJzdGFydEdhbWUiXSwic291cmNlUm9vdCI6IiJ9
>>>>>>> c8db90142714c5241cf20043366631c297f55e72
