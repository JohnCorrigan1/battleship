(()=>{"use strict";class e{constructor(){this.board=[],this.createBoard(),this.hits=[],this.misses=[],this.placedShips=[],this.gameOver=!1,this.sunkShips=[]}createBoard(){let e=0;for(let t=0;t<10;t++){this.board[t]=[];for(let s=0;s<10;s++)e++,this.board[t][s]=e}}placeShip(e,t,s){if(s&&!0===this.validPlacement(t,e.length,!0)){for(let s=0;s<e.length;s++){for(let s=0;s<this.board.length;s++)if(this.board[s].includes(t)){let n=this.board[s].indexOf(t);this.board[s][n]=e.name}t+=10}this.placedShips.push(e)}else if(!s&&!0===this.validPlacement(t,e.length,!1)){for(let s=0;s<e.length;s++){for(let s=0;s<this.board.length;s++)if(this.board[s].includes(t)){let n=this.board[s].indexOf(t);this.board[s][n]=e.name}t+=1}this.placedShips.push(e)}}recieveAttack(e,t){let s=e+t;Number.isInteger(this.board[e][t])?this.misses.push(s):(this.hits.push(s),this.placedShips.forEach((n=>{if(n.name===this.board[e][t])return n.hit(s),n.isSunk(),void(n.isSunk()&&this.sunkShips.push(n))})))}isOver(){return 4===this.sunkShips.length}validPlacement(e,t,s){let n=this.convertPosition(e),r=this.getRow(n),i=this.getCol(n);if(s&&r+t>10)return!1;if(!s&&i+t>10)return!1;if(s)for(let e=0;e<t;e++){if(!Number.isInteger(this.board[r][i]))return!1;r++}else for(let e=0;e<t;e++){if(!Number.isInteger(this.board[r][i]))return!1;i++}return!0}randomlyPlaceShips(e){let t,s,n=!1;for(;!n;)t=Math.floor(100*Math.random())+1,s=Math.random()<.5,this.validPlacement(t,e.length,s)?(n=!0,this.placeShip(e,t,s)):n=!1}convertPosition(e){let t,s,n=e.toString();return e<11?(t=e-1,s=0):100===e?(s=9,t=9):e%10==0?(s=parseInt(n.slice(0,1)),t=9):(s=parseInt(n.slice(0,1)),t=parseInt(n.slice(1,2))-1),s.toString()+t.toString()}getCol(e){return parseInt(e.slice(1,2))}getRow(e){return parseInt(e.slice(0,1))}}class t{constructor(t,s){this.gameboard=new e,this.name=t,this.shots=[],this.oponent=s}attack(e,t){let s=this.gameboard.convertPosition(e),n=this.gameboard.getRow(s),r=this.gameboard.getCol(s);this.shots.includes(e)||(this.shots.push(e),t.gameboard.recieveAttack(n,r),t.gameboard.isOver())}randomAttack(e){let t,s=!1;for(;!s;){t=Math.floor(100*Math.random())+1;let n=this.gameboard.convertPosition(t),r=this.gameboard.getRow(n),i=this.gameboard.getCol(n);if(!this.shots.includes(t))return console.log(t),this.shots.push(t),e.gameboard.recieveAttack(r,i),s=!0,t}}}class s{constructor(e,t){this.length=e,this.isHit=[],this.sunk=!1,this.name=t}hit(e){if(!this.isHit.includes(e)&&this.isHit.length<this.length)return this.isHit.push(e),this.isHit}isSunk(){return this.isHit.length===this.length&&(this.sunk=!0,!0)}}let n=new t("human","computer"),r=new t("computer","human"),i=n.gameboard.board,o=r.gameboard.board,a=new s(5,"carrier"),l=new s(4,"destroyer"),c=new s(3,"submarine"),d=new s(2,"patrol"),u=new s(5,"carrier"),h=new s(4,"destroyer"),m=new s(3,"submarine"),p=new s(2,"patrol");const g=[a,l,c,d],b=[u,h,m,p];function f(e){const t=document.querySelector(".info");null==t||t.classList.remove("info"),null==t||t.classList.add("hide");const s=document.querySelector(".place");null==s||s.classList.remove("hide"),document.querySelector(".place");const u=document.querySelector(".grid-container");document.querySelector(".title-1").textContent=e;const h=document.querySelector(".ships"),m=document.querySelector(".rotate"),p=document.querySelector(".carrier"),f=document.querySelector(".destroyer"),S=document.querySelector(".submarine"),v=document.querySelector(".patrol");let L;document.querySelectorAll(".draggable").forEach((e=>{e.addEventListener("dragstart",(()=>{e.classList.add("dragging")})),e.addEventListener("dragend",(t=>{var s,r;t.preventDefault(),e.classList.remove("dragging"),console.log("dropped"),console.log(t.target),console.log(t),L=t.target,console.log(k.dataset.hposition),console.log(L.id),s=parseInt(k.dataset.hposition),"carrier"===(r=L.id)&&(p.classList.contains("rotated")?n.gameboard.placeShip(a,s,!1):n.gameboard.placeShip(a,s,!0)),"destroyer"===r&&(p.classList.contains("rotated")?n.gameboard.placeShip(l,s,!1):n.gameboard.placeShip(l,s,!0)),"submarine"===r&&(p.classList.contains("rotated")?n.gameboard.placeShip(c,s,!1):n.gameboard.placeShip(c,s,!0)),"patrol"===r&&(p.classList.contains("rotated")?n.gameboard.placeShip(d,s,!1):n.gameboard.placeShip(d,s,!0)),u.innerHTML="",q()}))})),null==m||m.addEventListener("click",(function(){(null==p?void 0:p.classList.contains("rotated"))?(null==h||h.classList.remove("ships-horizontal"),null==h||h.classList.add("ships-vertical"),p.classList.remove("rotated"),null==f||f.classList.remove("rotated"),null==S||S.classList.remove("rotated"),null==v||v.classList.remove("rotated")):(null==h||h.classList.remove("ships-vertical"),null==h||h.classList.add("ships-horizontal"),null==p||p.classList.add("rotated"),null==f||f.classList.add("rotated"),null==S||S.classList.add("rotated"),null==v||v.classList.add("rotated"))}));const y=document.querySelector(".start-game");null==y||y.addEventListener("click",(function(){s.innerHTML="",function(e){document.querySelector("body");const t=document.querySelector(".place");null==t||t.classList.add("hide");const s=document.querySelector("#main");s.classList.remove("hide"),s.classList.add("main"),document.querySelector(".content"),document.querySelector(".grid1");const a=document.querySelector(".grid-container1");document.querySelector(".title-1").textContent=e;const l=document.querySelector(".sunken1"),c=(document.querySelector(".grid2"),document.querySelector(".grid-container2"));document.querySelector(".title-2").textContent="Computer";const d=document.querySelector(".sunken2"),u=document.querySelector(".who-won"),h=document.createElement("button");h.classList.add("restart"),h.textContent="Restart",h.addEventListener("click",(function(){location.reload()})),b.forEach((e=>{r.gameboard.randomlyPlaceShips(e)}));let m=0;for(let e=0;e<i.length;e++)for(let t=0;t<i[e].length;t++){m++;const s=document.createElement("div");s.setAttribute("hposition",m),Number.isInteger(i[e][t])||s.classList.add("ship-here"),s.classList.add("grid-item"),null==a||a.appendChild(s)}for(let t=0;t<o.length;t++)for(let s=0;s<o[t].length;s++){const a=document.createElement("div");a.setAttribute("cposition",o[t][s]),a.classList.add("grid-item"),a.classList.add("ai-grid"),a.addEventListener("click",(function(){if(a.classList.contains("hit")||a.classList.contains("miss")||n.gameboard.isOver()||r.gameboard.isOver())return;if(Number.isInteger(o[t][s]))a.classList.add("miss");else{a.classList.add("hit");let n=!1;if(r.gameboard.recieveAttack(t,s),r.gameboard.placedShips.forEach((e=>{e.name===o[t][s]&&(n=e.sunk)})),n){const n=document.createElement("h2");if(n.textContent=o[t][s],null==d||d.appendChild(n),r.gameboard.isOver()){const t=document.createElement("h1");t.textContent="Winner: "+e+"!",null==u||u.appendChild(t),null==u||u.appendChild(h)}}}let c;c=r.randomAttack(n);const m=document.querySelector(`[hposition="${c}"]`);let p=c,g=n.gameboard.convertPosition(p),b=n.gameboard.getRow(g),f=n.gameboard.getCol(g);if(Number.isInteger(n.gameboard.board[b][f]))null==m||m.classList.add("miss");else{null==m||m.classList.remove("ship-here"),null==m||m.classList.add("hit");let e=!1;if(n.gameboard.recieveAttack(t,s),n.gameboard.placedShips.forEach((t=>{t.name===i[b][f]&&(e=t.sunk)})),e){const e=document.createElement("h2");if(e.textContent=i[b][f],null==l||l.appendChild(e),n.gameboard.isOver()){const e=document.createElement("h1");e.textContent="Winner: Computer!",null==u||u.appendChild(e),null==u||u.appendChild(h)}}}})),null==c||c.appendChild(a)}}(e)}));let C=0;for(let e=0;e<i.length;e++)for(let t=0;t<i[e].length;t++){C++;const e=document.createElement("div");e.setAttribute("data-hposition",C),e.classList.add("grid-item"),null==u||u.appendChild(e)}function q(){let e=0;for(let t=0;t<i.length;t++)for(let s=0;s<i[t].length;s++){e++;const n=document.createElement("div");n.setAttribute("hposition",e),Number.isInteger(i[t][s])||n.classList.add("ship-here"),n.classList.add("grid-item"),null==u||u.appendChild(n)}}const E=document.querySelector(".randomly-place");let k;null==E||E.addEventListener("click",(function(){g.forEach((e=>{n.gameboard.randomlyPlaceShips(e)})),E.disabled=!0,u.innerHTML="",q()})),document.querySelectorAll(".grid-item").forEach((e=>{e.addEventListener("dragover",(e=>{k=e.target}))}))}!function(){const e=document.querySelector(".info"),t=document.createElement("div");t.classList.add("input-container");const s=document.createElement("label");s.textContent="Enter Name:";const n=document.createElement("input");n.classList.add("name-input");const r=document.createElement("button");r.classList.add("start-button"),r.textContent="Start",t.appendChild(s),t.appendChild(n),t.appendChild(r),null==e||e.appendChild(t),r.addEventListener("click",(function(){if(""!==n.value){const s=n.value;null==e||e.removeChild(t),f(s)}else{const s="To lazy to enter a name";null==e||e.removeChild(t),f(s)}}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVMsV0FDbEdyQixFQUFXN0MsU0FBU2hCLElBQ2hCaUQsRUFBTVosVUFBVVosbUJBQW1CekIsRUFBSyxJQUU1Q2dILEVBQWNDLFVBQVcsRUFDekJ6QyxFQUFNbUIsVUFBWSxHQUNsQkMsR0FDSixJQUVpQjFCLFNBQVNjLGlCQUFpQixjQUNsQ2hFLFNBQVM0RixJQUNkQSxFQUFLMUIsaUJBQWlCLFlBQWFDLElBQy9CRyxFQUFZSCxFQUFFRSxNQUFNLEdBQ3RCLEdBRVYsRUVwS2UsV0FDWCxNQUFNcEIsRUFBT0MsU0FBU0MsY0FBYyxTQUM5QitDLEVBQWlCaEQsU0FBU2tDLGNBQWMsT0FDOUNjLEVBQWU5QyxVQUFVRSxJQUFJLG1CQUM3QixNQUFNNkMsRUFBWWpELFNBQVNrQyxjQUFjLFNBQ3pDZSxFQUFVMUMsWUFBYyxjQUN4QixNQUFNMkMsRUFBWWxELFNBQVNrQyxjQUFjLFNBQ3pDZ0IsRUFBVWhELFVBQVVFLElBQUksY0FDeEIsTUFBTXVCLEVBQWMzQixTQUFTa0MsY0FBYyxVQUMzQ1AsRUFBWXpCLFVBQVVFLElBQUksZ0JBQzFCdUIsRUFBWXBCLFlBQWMsUUFDMUJ5QyxFQUFlVCxZQUFZVSxHQUMzQkQsRUFBZVQsWUFBWVcsR0FDM0JGLEVBQWVULFlBQVlaLEdBQzNCNUIsU0FBNENBLEVBQUt3QyxZQUFZUyxHQUM3RHJCLEVBQVlYLGlCQUFpQixTQUFTLFdBQ2xDLEdBQXdCLEtBQXBCa0MsRUFBVUMsTUFBYyxDQUN4QixNQUFNN0csRUFBTzRHLEVBQVVDLE1BQ3ZCcEQsU0FBNENBLEVBQUtxRCxZQUFZSixHQUM3RG5ELEVBQVd2RCxFQUNmLEtBQ0ssQ0FDRCxNQUFNQSxFQUFPLDBCQUNieUQsU0FBNENBLEVBQUtxRCxZQUFZSixHQUM3RG5ELEVBQVd2RCxFQUNmLENBQ0osR0FDSixDQzNCQStHLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9nYW1lYm9hcmQudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvcGxheWVycy50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9zaGlwLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvdWkvcGxhY2VTaGlwcy50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3VpL3JlbmRlckdhbWVCb2FyZHMudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy91aS9zdGFydEdhbWUudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBTaGlwIH0gZnJvbSAnLi9zaGlwJ1xyXG5leHBvcnQgY2xhc3MgR2FtZUJvYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXTtcclxuICAgICAgICB0aGlzLmNyZWF0ZUJvYXJkKCk7XHJcbiAgICAgICAgdGhpcy5oaXRzID0gW107XHJcbiAgICAgICAgdGhpcy5taXNzZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnBsYWNlZFNoaXBzID0gW107XHJcbiAgICAgICAgdGhpcy5nYW1lT3ZlciA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc3Vua1NoaXBzID0gW107XHJcbiAgICB9XHJcbiAgICBjcmVhdGVCb2FyZCgpIHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW2ldID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbaV1bal0gPSBjb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHBsYWNlU2hpcChzaGlwLCBzdGFydCwgdmVydGljYWwpIHtcclxuICAgICAgICBpZiAodmVydGljYWwgJiYgdGhpcy52YWxpZFBsYWNlbWVudChzdGFydCwgc2hpcC5sZW5ndGgsIHRydWUpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmJvYXJkLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRbal0uaW5jbHVkZXMoc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMuYm9hcmRbal0uaW5kZXhPZihzdGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbal1baW5kZXhdID0gc2hpcC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXJ0ICs9IDEwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VkU2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoIXZlcnRpY2FsICYmXHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRQbGFjZW1lbnQoc3RhcnQsIHNoaXAubGVuZ3RoLCBmYWxzZSkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuYm9hcmQubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ib2FyZFtqXS5pbmNsdWRlcyhzdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5ib2FyZFtqXS5pbmRleE9mKHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtqXVtpbmRleF0gPSBzaGlwLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RhcnQgKz0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBsYWNlZFNoaXBzLnB1c2goc2hpcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVjaWV2ZUF0dGFjayhyb3csIGNvbHVtbikge1xyXG4gICAgICAgIGxldCBwb3NpdGlvbiA9IHJvdyArIGNvbHVtbjtcclxuICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGl0cy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5wbGFjZWRTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hpcC5uYW1lID09PSB0aGlzLmJvYXJkW3Jvd11bY29sdW1uXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaXAuaGl0KHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBzaGlwLmlzU3VuaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLmlzU3VuaygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3Vua1NoaXBzLnB1c2goc2hpcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1pc3Nlcy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlzT3ZlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5zdW5rU2hpcHMubGVuZ3RoID09PSA0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YWxpZFBsYWNlbWVudChwb3NpdGlvbiwgbGVuZ3RoLCBpc1ZlcnRpY2FsKSB7XHJcbiAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gdGhpcy5jb252ZXJ0UG9zaXRpb24ocG9zaXRpb24pO1xyXG4gICAgICAgIGxldCByb3cgPSB0aGlzLmdldFJvdyhuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgbGV0IGNvbHVtbiA9IHRoaXMuZ2V0Q29sKG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICBpZiAoaXNWZXJ0aWNhbCAmJiByb3cgKyBsZW5ndGggPiAxMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCFpc1ZlcnRpY2FsICYmIGNvbHVtbiArIGxlbmd0aCA+IDEwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzVmVydGljYWwpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHRoaXMuYm9hcmRbcm93XVtjb2x1bW5dKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJvdysrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByYW5kb21seVBsYWNlU2hpcHMoc2hpcCkge1xyXG4gICAgICAgIGxldCB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBwb3NpdGlvbjtcclxuICAgICAgICBsZXQgZGlyZWN0aW9uO1xyXG4gICAgICAgIHdoaWxlICghdmFsaWQpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsgMTtcclxuICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjUpIHtcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy52YWxpZFBsYWNlbWVudChwb3NpdGlvbiwgc2hpcC5sZW5ndGgsIGRpcmVjdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxhY2VTaGlwKHNoaXAsIHBvc2l0aW9uLCBkaXJlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29udmVydFBvc2l0aW9uKHBvc2l0aW9uKSB7XHJcbiAgICAgICAgbGV0IGNvbHVtbjtcclxuICAgICAgICBsZXQgc3RyID0gcG9zaXRpb24udG9TdHJpbmcoKTtcclxuICAgICAgICBsZXQgcm93O1xyXG4gICAgICAgIGlmIChwb3NpdGlvbiA8IDExKSB7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IHBvc2l0aW9uIC0gMTtcclxuICAgICAgICAgICAgcm93ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocG9zaXRpb24gPT09IDEwMCkge1xyXG4gICAgICAgICAgICByb3cgPSA5O1xyXG4gICAgICAgICAgICBjb2x1bW4gPSA5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3NpdGlvbiAlIDEwID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJvdyA9IHBhcnNlSW50KHN0ci5zbGljZSgwLCAxKSk7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IDk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByb3cgPSBwYXJzZUludChzdHIuc2xpY2UoMCwgMSkpO1xyXG4gICAgICAgICAgICBjb2x1bW4gPSBwYXJzZUludChzdHIuc2xpY2UoMSwgMikpIC0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHN0clJvdyA9IHJvdy50b1N0cmluZygpO1xyXG4gICAgICAgIGxldCBzdHJDb2wgPSBjb2x1bW4udG9TdHJpbmcoKTtcclxuICAgICAgICBsZXQgbmV3UG9zaXRpb24gPSBzdHJSb3cgKyBzdHJDb2w7XHJcbiAgICAgICAgcmV0dXJuIG5ld1Bvc2l0aW9uO1xyXG4gICAgfVxyXG4gICAgZ2V0Q29sKHN0cikge1xyXG4gICAgICAgIHJldHVybiBwYXJzZUludChzdHIuc2xpY2UoMSwgMikpO1xyXG4gICAgfVxyXG4gICAgZ2V0Um93KHN0cikge1xyXG4gICAgICAgIHJldHVybiBwYXJzZUludChzdHIuc2xpY2UoMCwgMSkpO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IEdhbWVCb2FyZCB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5leHBvcnQgY2xhc3MgUGxheWVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUsIG9wb25lbnQpIHtcclxuICAgICAgICB0aGlzLmdhbWVib2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuc2hvdHMgPSBbXTtcclxuICAgICAgICB0aGlzLm9wb25lbnQgPSBvcG9uZW50O1xyXG4gICAgfVxyXG4gICAgYXR0YWNrKHBvc2l0aW9uLCBvcG9uZW50KSB7XHJcbiAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gdGhpcy5nYW1lYm9hcmQuY29udmVydFBvc2l0aW9uKHBvc2l0aW9uKTtcclxuICAgICAgICBsZXQgcm93ID0gdGhpcy5nYW1lYm9hcmQuZ2V0Um93KG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICBsZXQgY29sID0gdGhpcy5nYW1lYm9hcmQuZ2V0Q29sKG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICBpZiAoIXRoaXMuc2hvdHMuaW5jbHVkZXMocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdHMucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIG9wb25lbnQuZ2FtZWJvYXJkLnJlY2lldmVBdHRhY2socm93LCBjb2wpO1xyXG4gICAgICAgICAgICBpZiAob3BvbmVudC5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2dcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJhbmRvbUF0dGFjayhvcHBvbmVudCkge1xyXG4gICAgICAgIGxldCB2YWxpZFNob3QgPSBmYWxzZTtcclxuICAgICAgICBsZXQgcG9zaXRpb247XHJcbiAgICAgICAgd2hpbGUgKCF2YWxpZFNob3QpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsgMTtcclxuICAgICAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gdGhpcy5nYW1lYm9hcmQuY29udmVydFBvc2l0aW9uKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgbGV0IHJvdyA9IHRoaXMuZ2FtZWJvYXJkLmdldFJvdyhuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgICAgIGxldCBjb2wgPSB0aGlzLmdhbWVib2FyZC5nZXRDb2wobmV3UG9zaXRpb24pO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2hvdHMuaW5jbHVkZXMocG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3RzLnB1c2gocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgb3Bwb25lbnQuZ2FtZWJvYXJkLnJlY2lldmVBdHRhY2socm93LCBjb2wpO1xyXG4gICAgICAgICAgICAgICAgdmFsaWRTaG90ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vIGxldCBzdHI6IHN0cmluZ1xyXG4gICAgICAgICAgICAgICAgLy8gc3RyID0gcm93LnRvU3RyaW5nKCkgKyBjb2wudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBTaGlwIHtcclxuICAgIGNvbnN0cnVjdG9yKGxlbmd0aCwgbmFtZSkge1xyXG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xyXG4gICAgICAgIHRoaXMuaXNIaXQgPSBbXTtcclxuICAgICAgICB0aGlzLnN1bmsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG4gICAgaGl0KHBvc2l0aW9uKSB7XHJcbiAgICAgICAgLy9wdXNoIHBvc2l0aW9uIHRvIGlzaGl0IGFycmF5XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzSGl0LmluY2x1ZGVzKHBvc2l0aW9uKSAmJiB0aGlzLmlzSGl0Lmxlbmd0aCA8IHRoaXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNIaXQucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzSGl0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlzU3VuaygpIHtcclxuICAgICAgICAvL2NoZWNrcyBlYWNoIHBvc2l0aW9uIG9mIHNoaXAgZm9yIGhpdHMgaWYgYWxsIGFyZSBoaXQgaXMgc3Vua1xyXG4gICAgICAgIGlmICh0aGlzLmlzSGl0Lmxlbmd0aCA9PT0gdGhpcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5zdW5rID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi8uLi9mYWN0b3JpZXMvcGxheWVyc1wiO1xyXG5pbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vLi4vZmFjdG9yaWVzL3NoaXBcIjtcclxuaW1wb3J0IHJlbmRlckdyaWRzIGZyb20gXCIuL3JlbmRlckdhbWVCb2FyZHNcIjtcclxubGV0IGh1bWFuID0gbmV3IFBsYXllcihcImh1bWFuXCIsIFwiY29tcHV0ZXJcIik7XHJcbmxldCBjb21wdXRlciA9IG5ldyBQbGF5ZXIoXCJjb21wdXRlclwiLCBcImh1bWFuXCIpO1xyXG5sZXQgaEJvYXJkID0gaHVtYW4uZ2FtZWJvYXJkLmJvYXJkO1xyXG5sZXQgY0JvYXJkID0gY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkO1xyXG5sZXQgaENhcnJpZXIgPSBuZXcgU2hpcCg1LCBcImNhcnJpZXJcIik7XHJcbmxldCBoRGVzdHJveWVyID0gbmV3IFNoaXAoNCwgXCJkZXN0cm95ZXJcIik7XHJcbmxldCBoU3VibWFyaW5lID0gbmV3IFNoaXAoMywgXCJzdWJtYXJpbmVcIik7XHJcbmxldCBoUGF0cm9sID0gbmV3IFNoaXAoMiwgXCJwYXRyb2xcIik7XHJcbmxldCBjQ2FycmllciA9IG5ldyBTaGlwKDUsIFwiY2FycmllclwiKTtcclxubGV0IGNEZXN0cm95ZXIgPSBuZXcgU2hpcCg0LCBcImRlc3Ryb3llclwiKTtcclxubGV0IGNTdWJtYXJpbmUgPSBuZXcgU2hpcCgzLCBcInN1Ym1hcmluZVwiKTtcclxubGV0IGNQYXRyb2wgPSBuZXcgU2hpcCgyLCBcInBhdHJvbFwiKTtcclxuY29uc3QgaHVtYW5TaGlwcyA9IFtoQ2FycmllciwgaERlc3Ryb3llciwgaFN1Ym1hcmluZSwgaFBhdHJvbF07XHJcbmNvbnN0IGNvbXB1dGVyU2hpcHMgPSBbY0NhcnJpZXIsIGNEZXN0cm95ZXIsIGNTdWJtYXJpbmUsIGNQYXRyb2xdO1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBwbGFjZVNoaXBzKHBsYXllck5hbWUpIHtcclxuICAgIGNvbnN0IGluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uY2xhc3NMaXN0LnJlbW92ZShcImluZm9cIik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XHJcbiAgICBjb25zdCBwbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VcIik7XHJcbiAgICBwbGFjZSA9PT0gbnVsbCB8fCBwbGFjZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGxhY2UuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlXCIpO1xyXG4gICAgLy8gIGNvbnN0IGdyaWRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3JpZC1jb250YWluZXInKSFcclxuICAgIGNvbnN0IGdyaWQxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkLWNvbnRhaW5lclwiKTtcclxuICAgIGNvbnN0IHRpdGxlMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGUtMVwiKTtcclxuICAgIHRpdGxlMS50ZXh0Q29udGVudCA9IHBsYXllck5hbWU7XHJcbiAgICBjb25zdCBzaGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hpcHNcIik7XHJcbiAgICBjb25zdCByb3RhdGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJvdGF0ZVwiKTtcclxuICAgIGNvbnN0IGNhcnJpZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcnJpZXJcIik7XHJcbiAgICBjb25zdCBkZXN0cm95ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlc3Ryb3llclwiKTtcclxuICAgIGNvbnN0IHN1Ym1hcmluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3VibWFyaW5lXCIpO1xyXG4gICAgY29uc3QgcGF0cm9sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wYXRyb2xcIik7XHJcbiAgICBjb25zdCBkcmFnZ2FibGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5kcmFnZ2FibGVcIik7XHJcbiAgICBsZXQgc2hpcDtcclxuICAgIGRyYWdnYWJsZXMuZm9yRWFjaCgoZHJhZ2dhYmxlKSA9PiB7XHJcbiAgICAgICAgZHJhZ2dhYmxlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICBkcmFnZ2FibGUuY2xhc3NMaXN0LmFkZChcImRyYWdnaW5nXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGRyYWdnYWJsZS5jbGFzc0xpc3QucmVtb3ZlKFwiZHJhZ2dpbmdcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZHJvcHBlZFwiKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgICAgICAgc2hpcCA9IGUudGFyZ2V0O1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlLnRvRWxlbWVudC5pZClcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocGxhY2VIZXJlLmRhdGFzZXQuaHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2hpcC5pZCk7XHJcbiAgICAgICAgICAgIGxldCBzaGlwUG9zaXRpb24gPSBwYXJzZUludChwbGFjZUhlcmUuZGF0YXNldC5ocG9zaXRpb24pO1xyXG4gICAgICAgICAgICBsZXQgc2hpcE5hbWUgPSBzaGlwLmlkO1xyXG4gICAgICAgICAgICBwbGFjZVNoaXBEcmFnZ2VkKHNoaXBQb3NpdGlvbiwgc2hpcE5hbWUpO1xyXG4gICAgICAgICAgICBjaGVja0JvYXJkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGZ1bmN0aW9uIHBsYWNlU2hpcERyYWdnZWQocG9zaXRpb24sIG5hbWUpIHtcclxuICAgICAgICBpZiAobmFtZSA9PT0gXCJjYXJyaWVyXCIpIHtcclxuICAgICAgICAgICAgaWYgKGNhcnJpZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwicm90YXRlZFwiKSkge1xyXG4gICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLnBsYWNlU2hpcChoQ2FycmllciwgcG9zaXRpb24sIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZVNoaXAoaENhcnJpZXIsIHBvc2l0aW9uLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmFtZSA9PT0gXCJkZXN0cm95ZXJcIikge1xyXG4gICAgICAgICAgICBpZiAoY2Fycmllci5jbGFzc0xpc3QuY29udGFpbnMoXCJyb3RhdGVkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhEZXN0cm95ZXIsIHBvc2l0aW9uLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhEZXN0cm95ZXIsIHBvc2l0aW9uLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmFtZSA9PT0gXCJzdWJtYXJpbmVcIikge1xyXG4gICAgICAgICAgICBpZiAoY2Fycmllci5jbGFzc0xpc3QuY29udGFpbnMoXCJyb3RhdGVkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhTdWJtYXJpbmUsIHBvc2l0aW9uLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhTdWJtYXJpbmUsIHBvc2l0aW9uLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmFtZSA9PT0gXCJwYXRyb2xcIikge1xyXG4gICAgICAgICAgICBpZiAoY2Fycmllci5jbGFzc0xpc3QuY29udGFpbnMoXCJyb3RhdGVkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhQYXRyb2wsIHBvc2l0aW9uLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucGxhY2VTaGlwKGhQYXRyb2wsIHBvc2l0aW9uLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBncmlkMS5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgICAgIC8vIGNoZWNrQm9hcmQoKTtcclxuICAgIH1cclxuICAgIHJvdGF0ZUJ1dHRvbiA9PT0gbnVsbCB8fCByb3RhdGVCdXR0b24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJvdGF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjYXJyaWVyID09PSBudWxsIHx8IGNhcnJpZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNhcnJpZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwicm90YXRlZFwiKSkge1xyXG4gICAgICAgICAgICBzaGlwcyA9PT0gbnVsbCB8fCBzaGlwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2hpcHMuY2xhc3NMaXN0LnJlbW92ZShcInNoaXBzLWhvcml6b250YWxcIik7XHJcbiAgICAgICAgICAgIHNoaXBzID09PSBudWxsIHx8IHNoaXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzaGlwcy5jbGFzc0xpc3QuYWRkKFwic2hpcHMtdmVydGljYWxcIik7XHJcbiAgICAgICAgICAgIGNhcnJpZXIuY2xhc3NMaXN0LnJlbW92ZShcInJvdGF0ZWRcIik7XHJcbiAgICAgICAgICAgIGRlc3Ryb3llciA9PT0gbnVsbCB8fCBkZXN0cm95ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRlc3Ryb3llci5jbGFzc0xpc3QucmVtb3ZlKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgc3VibWFyaW5lID09PSBudWxsIHx8IHN1Ym1hcmluZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3VibWFyaW5lLmNsYXNzTGlzdC5yZW1vdmUoXCJyb3RhdGVkXCIpO1xyXG4gICAgICAgICAgICBwYXRyb2wgPT09IG51bGwgfHwgcGF0cm9sID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwYXRyb2wuY2xhc3NMaXN0LnJlbW92ZShcInJvdGF0ZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzaGlwcyA9PT0gbnVsbCB8fCBzaGlwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2hpcHMuY2xhc3NMaXN0LnJlbW92ZShcInNoaXBzLXZlcnRpY2FsXCIpO1xyXG4gICAgICAgICAgICBzaGlwcyA9PT0gbnVsbCB8fCBzaGlwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2hpcHMuY2xhc3NMaXN0LmFkZChcInNoaXBzLWhvcml6b250YWxcIik7XHJcbiAgICAgICAgICAgIGNhcnJpZXIgPT09IG51bGwgfHwgY2FycmllciA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2Fycmllci5jbGFzc0xpc3QuYWRkKFwicm90YXRlZFwiKTtcclxuICAgICAgICAgICAgZGVzdHJveWVyID09PSBudWxsIHx8IGRlc3Ryb3llciA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVzdHJveWVyLmNsYXNzTGlzdC5hZGQoXCJyb3RhdGVkXCIpO1xyXG4gICAgICAgICAgICBzdWJtYXJpbmUgPT09IG51bGwgfHwgc3VibWFyaW5lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdWJtYXJpbmUuY2xhc3NMaXN0LmFkZChcInJvdGF0ZWRcIik7XHJcbiAgICAgICAgICAgIHBhdHJvbCA9PT0gbnVsbCB8fCBwYXRyb2wgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhdHJvbC5jbGFzc0xpc3QuYWRkKFwicm90YXRlZFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IHN0YXJ0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdGFydC1nYW1lXCIpO1xyXG4gICAgc3RhcnRCdXR0b24gPT09IG51bGwgfHwgc3RhcnRCdXR0b24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0YXJ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gZ3JpZDEuY2xhc3NMaXN0LmFkZCgnaGlkZScpXHJcbiAgICAgICAgcGxhY2UuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICByZW5kZXJHcmlkcyhwbGF5ZXJOYW1lKTtcclxuICAgIH0pO1xyXG4gICAgbGV0IGRyb3BwZWRBdDtcclxuICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhCb2FyZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaEJvYXJkW2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyaWRJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgZ3JpZEl0ZW0uc2V0QXR0cmlidXRlKFwiZGF0YS1ocG9zaXRpb25cIiwgY291bnQpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwiZ3JpZC1pdGVtXCIpO1xyXG4gICAgICAgICAgICBncmlkMSA9PT0gbnVsbCB8fCBncmlkMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ3JpZDEuYXBwZW5kQ2hpbGQoZ3JpZEl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNoZWNrQm9hcmQoKSB7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhCb2FyZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGhCb2FyZFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGdyaWRJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgICAgIGdyaWRJdGVtLnNldEF0dHJpYnV0ZShcImhwb3NpdGlvblwiLCBjb3VudCk7XHJcbiAgICAgICAgICAgICAgICAvLyBncmlkSXRlbS50ZXh0Q29udGVudCA9IGJvYXJkW2ldW2pdXHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoaEJvYXJkW2ldW2pdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJzaGlwLWhlcmVcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwiZ3JpZC1pdGVtXCIpO1xyXG4gICAgICAgICAgICAgICAgZ3JpZDEgPT09IG51bGwgfHwgZ3JpZDEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdyaWQxLmFwcGVuZENoaWxkKGdyaWRJdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vICAgZnVuY3Rpb24gY2hlY2tHcmlkKCkge1xyXG4gICAgLy8gICAgIGxldCBncmlkSXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JpZC1pdGVtJylcclxuICAgIC8vICAgICBncmlkSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIC8vICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKCkpXHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vICAgfVxyXG4gICAgY29uc3QgcmFuZG9tbHlQbGFjZSA9IChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJhbmRvbWx5LXBsYWNlXCIpKTtcclxuICAgIHJhbmRvbWx5UGxhY2UgPT09IG51bGwgfHwgcmFuZG9tbHlQbGFjZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmFuZG9tbHlQbGFjZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGh1bWFuU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQucmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJhbmRvbWx5UGxhY2UuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGdyaWQxLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgY2hlY2tCb2FyZCgpO1xyXG4gICAgfSk7XHJcbiAgICBsZXQgcGxhY2VIZXJlO1xyXG4gICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmdyaWQtaXRlbVwiKTtcclxuICAgIGdyaWRJdGVtLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBwbGFjZUhlcmUgPSBlLnRhcmdldDtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydCB7IGh1bWFuU2hpcHMsIGNvbXB1dGVyU2hpcHMsIGh1bWFuLCBjb21wdXRlciwgaEJvYXJkLCBjQm9hcmQgfTtcclxuIiwiaW1wb3J0IHsgY29tcHV0ZXJTaGlwcywgaHVtYW4sIGNvbXB1dGVyLCBoQm9hcmQsIGNCb2FyZCB9IGZyb20gXCIuLi91aS9wbGFjZVNoaXBzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlbmRlckdyaWRzKHBsYXllck5hbWUpIHtcclxuICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcclxuICAgIC8vIGNvbnN0IGluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIik7XHJcbiAgICAvLyBpbmZvPy5jbGFzc0xpc3QucmVtb3ZlKFwiaW5mb1wiKTtcclxuICAgIC8vIGluZm8/LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xyXG4gICAgY29uc3QgcGxhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2UnKTtcclxuICAgIHBsYWNlID09PSBudWxsIHx8IHBsYWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbGFjZS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtYWluXCIpO1xyXG4gICAgbWFpbi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcclxuICAgIG1haW4uY2xhc3NMaXN0LmFkZChcIm1haW5cIik7XHJcbiAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250ZW50XCIpO1xyXG4gICAgY29uc3QgZ3JpZENvbnRhaW5lcjEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQxXCIpO1xyXG4gICAgY29uc3QgZ3JpZDEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQtY29udGFpbmVyMVwiKTtcclxuICAgIGNvbnN0IHRpdGxlMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGUtMVwiKTtcclxuICAgIHRpdGxlMS50ZXh0Q29udGVudCA9IHBsYXllck5hbWU7XHJcbiAgICBjb25zdCBzdW5rZW4xID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdW5rZW4xXCIpO1xyXG4gICAgY29uc3QgZ3JpZENvbnRhaW5lcjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQyXCIpO1xyXG4gICAgY29uc3QgZ3JpZDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdyaWQtY29udGFpbmVyMlwiKTtcclxuICAgIGNvbnN0IHRpdGxlMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGUtMlwiKTtcclxuICAgIHRpdGxlMi50ZXh0Q29udGVudCA9IFwiQ29tcHV0ZXJcIjtcclxuICAgIGNvbnN0IHN1bmtlbjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN1bmtlbjJcIik7XHJcbiAgICBjb25zdCB3aG9Xb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndoby13b25cIik7XHJcbiAgICBjb25zdCByZXN0YXJ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuICAgIHJlc3RhcnQuY2xhc3NMaXN0LmFkZChcInJlc3RhcnRcIik7XHJcbiAgICByZXN0YXJ0LnRleHRDb250ZW50ID0gXCJSZXN0YXJ0XCI7XHJcbiAgICByZXN0YXJ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICB9KTtcclxuICAgIC8vIGxldCBodW1hbiA9IG5ldyBQbGF5ZXIoXCJodW1hblwiLCBcImNvbXB1dGVyXCIpO1xyXG4gICAgLy8gbGV0IGNvbXB1dGVyID0gbmV3IFBsYXllcihcImNvbXB1dGVyXCIsIFwiaHVtYW5cIik7XHJcbiAgICAvLyBsZXQgaEJvYXJkID0gaHVtYW4uZ2FtZWJvYXJkLmJvYXJkO1xyXG4gICAgLy8gbGV0IGNCb2FyZCA9IGNvbXB1dGVyLmdhbWVib2FyZC5ib2FyZDtcclxuICAgIC8vIGxldCBoQ2FycmllciA9IG5ldyBTaGlwKDUsIFwiY2FycmllclwiKTtcclxuICAgIC8vIGxldCBoRGVzdHJveWVyID0gbmV3IFNoaXAoNCwgXCJkZXN0cm95ZXJcIik7XHJcbiAgICAvLyBsZXQgaFN1Ym1hcmluZSA9IG5ldyBTaGlwKDMsIFwic3VibWFyaW5lXCIpO1xyXG4gICAgLy8gbGV0IGhQYXRyb2wgPSBuZXcgU2hpcCgyLCBcInBhdHJvbFwiKTtcclxuICAgIC8vIGxldCBjQ2FycmllciA9IG5ldyBTaGlwKDUsIFwiY2FycmllclwiKTtcclxuICAgIC8vIGxldCBjRGVzdHJveWVyID0gbmV3IFNoaXAoNCwgXCJkZXN0cm95ZXJcIik7XHJcbiAgICAvLyBsZXQgY1N1Ym1hcmluZSA9IG5ldyBTaGlwKDMsIFwic3VibWFyaW5lXCIpO1xyXG4gICAgLy8gbGV0IGNQYXRyb2wgPSBuZXcgU2hpcCgyLCBcInBhdHJvbFwiKTtcclxuICAgIC8vIGNvbnN0IGh1bWFuU2hpcHMgPSBbaENhcnJpZXIsIGhEZXN0cm95ZXIsIGhTdWJtYXJpbmUsIGhQYXRyb2xdO1xyXG4gICAgLy8gY29uc3QgY29tcHV0ZXJTaGlwcyA9IFtjQ2FycmllciwgY0Rlc3Ryb3llciwgY1N1Ym1hcmluZSwgY1BhdHJvbF07XHJcbiAgICAvLyBhbGxTaGlwcy5mb3JFYWNoKHNoaXAgPT4ge1xyXG4gICAgLy8gICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICAvLyAgICAgaHVtYW4uZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIC8vIH0pXHJcbiAgICBjb21wdXRlclNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcclxuICAgICAgICBjb21wdXRlci5nYW1lYm9hcmQucmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApO1xyXG4gICAgfSk7XHJcbiAgICAvLyBodW1hblNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcclxuICAgIC8vICAgaHVtYW4uZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIC8vIH0pO1xyXG4gICAgbGV0IGNvdW50ID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaEJvYXJkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBoQm9hcmRbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5zZXRBdHRyaWJ1dGUoXCJocG9zaXRpb25cIiwgY291bnQpO1xyXG4gICAgICAgICAgICAvLyBncmlkSXRlbS50ZXh0Q29udGVudCA9IGJvYXJkW2ldW2pdXHJcbiAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihoQm9hcmRbaV1bal0pKSB7XHJcbiAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwic2hpcC1oZXJlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgICAgIGdyaWQxID09PSBudWxsIHx8IGdyaWQxID09PSB2b2lkIDAgPyB2b2lkIDAgOiBncmlkMS5hcHBlbmRDaGlsZChncmlkSXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjQm9hcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNCb2FyZFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBjb25zdCBncmlkSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLnNldEF0dHJpYnV0ZShcImNwb3NpdGlvblwiLCBjQm9hcmRbaV1bal0pO1xyXG4gICAgICAgICAgICAvLyBncmlkSXRlbS50ZXh0Q29udGVudCA9IGJvYXJkW2ldW2pdXHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJhaS1ncmlkXCIpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGdyaWRJdGVtLmNsYXNzTGlzdC5jb250YWlucyhcImhpdFwiKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5jb250YWlucyhcIm1pc3NcIikgfHxcclxuICAgICAgICAgICAgICAgICAgICBodW1hbi5nYW1lYm9hcmQuaXNPdmVyKCkgfHxcclxuICAgICAgICAgICAgICAgICAgICBjb21wdXRlci5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoY0JvYXJkW2ldW2pdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlzU3VuayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKGksIGopO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5wbGFjZWRTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLm5hbWUgPT09IGNCb2FyZFtpXVtqXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTdW5rID0gc2hpcC5zdW5rO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzU3Vuaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW5rZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbi50ZXh0Q29udGVudCA9IGNCb2FyZFtpXVtqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vua2VuMiA9PT0gbnVsbCB8fCBzdW5rZW4yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdW5rZW4yLmFwcGVuZENoaWxkKHN1bmtlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wdXRlci5nYW1lYm9hcmQuaXNPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbm5lci50ZXh0Q29udGVudCA9IFwiV2lubmVyOiBcIiArIHBsYXllck5hbWUgKyBcIiFcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdob1dvbiA9PT0gbnVsbCB8fCB3aG9Xb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdob1dvbi5hcHBlbmRDaGlsZCh3aW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hvV29uID09PSBudWxsIHx8IHdob1dvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogd2hvV29uLmFwcGVuZENoaWxkKHJlc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgcG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGNvbXB1dGVyLnJhbmRvbUF0dGFjayhodW1hbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2hwb3NpdGlvbj1cIiR7cG9zaXRpb259XCJdYCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IHBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gaHVtYW4uZ2FtZWJvYXJkLmNvbnZlcnRQb3NpdGlvbih0ZW1wKTtcclxuICAgICAgICAgICAgICAgIGxldCByb3cgPSBodW1hbi5nYW1lYm9hcmQuZ2V0Um93KG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGxldCBjb2wgPSBodW1hbi5nYW1lYm9hcmQuZ2V0Q29sKG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihodW1hbi5nYW1lYm9hcmQuYm9hcmRbcm93XVtjb2xdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdzaGlwLWhlcmUnKTtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtID09PSBudWxsIHx8IGl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGl0ZW0uY2xhc3NMaXN0LmFkZChcImhpdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaXNTdW5rMSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKGksIGopO1xyXG4gICAgICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZWRTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLm5hbWUgPT09IGhCb2FyZFtyb3ddW2NvbF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU3VuazEgPSBzaGlwLnN1bms7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdW5rMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW5rZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbi50ZXh0Q29udGVudCA9IGhCb2FyZFtyb3ddW2NvbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbjEgPT09IG51bGwgfHwgc3Vua2VuMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3Vua2VuMS5hcHBlbmRDaGlsZChzdW5rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHVtYW4uZ2FtZWJvYXJkLmlzT3ZlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3aW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBcIldpbm5lcjogQ29tcHV0ZXIhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aG9Xb24gPT09IG51bGwgfHwgd2hvV29uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB3aG9Xb24uYXBwZW5kQ2hpbGQod2lubmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdob1dvbiA9PT0gbnVsbCB8fCB3aG9Xb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdob1dvbi5hcHBlbmRDaGlsZChyZXN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGdyaWQyID09PSBudWxsIHx8IGdyaWQyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBncmlkMi5hcHBlbmRDaGlsZChncmlkSXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBwbGFjZVNoaXBzIGZyb20gXCIuL3BsYWNlU2hpcHNcIjtcclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3RhcnRHYW1lKCkge1xyXG4gICAgY29uc3QgaW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW5mb1wiKTtcclxuICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGlucHV0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpbnB1dC1jb250YWluZXJcIik7XHJcbiAgICBjb25zdCBuYW1lTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgICBuYW1lTGFiZWwudGV4dENvbnRlbnQgPSBcIkVudGVyIE5hbWU6XCI7XHJcbiAgICBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICBuYW1lSW5wdXQuY2xhc3NMaXN0LmFkZChcIm5hbWUtaW5wdXRcIik7XHJcbiAgICBjb25zdCBzdGFydEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICBzdGFydEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwic3RhcnQtYnV0dG9uXCIpO1xyXG4gICAgc3RhcnRCdXR0b24udGV4dENvbnRlbnQgPSBcIlN0YXJ0XCI7XHJcbiAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChuYW1lTGFiZWwpO1xyXG4gICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQobmFtZUlucHV0KTtcclxuICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXJ0QnV0dG9uKTtcclxuICAgIGluZm8gPT09IG51bGwgfHwgaW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5mby5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcik7XHJcbiAgICBzdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChuYW1lSW5wdXQudmFsdWUgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IG5hbWVJbnB1dC52YWx1ZTtcclxuICAgICAgICAgICAgaW5mbyA9PT0gbnVsbCB8fCBpbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmZvLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKTtcclxuICAgICAgICAgICAgcGxhY2VTaGlwcyhuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBcIlRvIGxhenkgdG8gZW50ZXIgYSBuYW1lXCI7XHJcbiAgICAgICAgICAgIGluZm8gPT09IG51bGwgfHwgaW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5mby5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIHBsYWNlU2hpcHMobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuIiwiaW1wb3J0IHN0YXJ0R2FtZSBmcm9tIFwiLi91aS9zdGFydEdhbWVcIjtcclxuc3RhcnRHYW1lKCk7XHJcbi8vIHJlbmRlckdyaWRzKCdqamNyYXp5bWFuJylcclxuIl0sIm5hbWVzIjpbIkdhbWVCb2FyZCIsImNvbnN0cnVjdG9yIiwidGhpcyIsImJvYXJkIiwiY3JlYXRlQm9hcmQiLCJoaXRzIiwibWlzc2VzIiwicGxhY2VkU2hpcHMiLCJnYW1lT3ZlciIsInN1bmtTaGlwcyIsImNvdW50IiwiaSIsImoiLCJwbGFjZVNoaXAiLCJzaGlwIiwic3RhcnQiLCJ2ZXJ0aWNhbCIsInZhbGlkUGxhY2VtZW50IiwibGVuZ3RoIiwiaW5jbHVkZXMiLCJpbmRleCIsImluZGV4T2YiLCJuYW1lIiwicHVzaCIsInJlY2lldmVBdHRhY2siLCJyb3ciLCJjb2x1bW4iLCJwb3NpdGlvbiIsIk51bWJlciIsImlzSW50ZWdlciIsImZvckVhY2giLCJoaXQiLCJpc1N1bmsiLCJpc092ZXIiLCJpc1ZlcnRpY2FsIiwibmV3UG9zaXRpb24iLCJjb252ZXJ0UG9zaXRpb24iLCJnZXRSb3ciLCJnZXRDb2wiLCJyYW5kb21seVBsYWNlU2hpcHMiLCJkaXJlY3Rpb24iLCJ2YWxpZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInN0ciIsInRvU3RyaW5nIiwicGFyc2VJbnQiLCJzbGljZSIsIlBsYXllciIsIm9wb25lbnQiLCJnYW1lYm9hcmQiLCJzaG90cyIsImF0dGFjayIsImNvbCIsInJhbmRvbUF0dGFjayIsIm9wcG9uZW50IiwidmFsaWRTaG90IiwiY29uc29sZSIsImxvZyIsIlNoaXAiLCJpc0hpdCIsInN1bmsiLCJodW1hbiIsImNvbXB1dGVyIiwiaEJvYXJkIiwiY0JvYXJkIiwiaENhcnJpZXIiLCJoRGVzdHJveWVyIiwiaFN1Ym1hcmluZSIsImhQYXRyb2wiLCJjQ2FycmllciIsImNEZXN0cm95ZXIiLCJjU3VibWFyaW5lIiwiY1BhdHJvbCIsImh1bWFuU2hpcHMiLCJjb21wdXRlclNoaXBzIiwicGxhY2VTaGlwcyIsInBsYXllck5hbWUiLCJpbmZvIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwicGxhY2UiLCJncmlkMSIsInRleHRDb250ZW50Iiwic2hpcHMiLCJyb3RhdGVCdXR0b24iLCJjYXJyaWVyIiwiZGVzdHJveWVyIiwic3VibWFyaW5lIiwicGF0cm9sIiwicXVlcnlTZWxlY3RvckFsbCIsImRyYWdnYWJsZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJwbGFjZUhlcmUiLCJkYXRhc2V0IiwiaHBvc2l0aW9uIiwiaWQiLCJjb250YWlucyIsImlubmVySFRNTCIsImNoZWNrQm9hcmQiLCJzdGFydEJ1dHRvbiIsIm1haW4iLCJzdW5rZW4xIiwiZ3JpZDIiLCJzdW5rZW4yIiwid2hvV29uIiwicmVzdGFydCIsImNyZWF0ZUVsZW1lbnQiLCJsb2NhdGlvbiIsInJlbG9hZCIsImdyaWRJdGVtIiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJzdW5rZW4iLCJ3aW5uZXIiLCJpdGVtIiwidGVtcCIsImlzU3VuazEiLCJyZW5kZXJHcmlkcyIsInJhbmRvbWx5UGxhY2UiLCJkaXNhYmxlZCIsImlucHV0Q29udGFpbmVyIiwibmFtZUxhYmVsIiwibmFtZUlucHV0IiwidmFsdWUiLCJyZW1vdmVDaGlsZCIsInN0YXJ0R2FtZSJdLCJzb3VyY2VSb290IjoiIn0=