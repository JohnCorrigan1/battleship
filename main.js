(()=>{"use strict";class e{constructor(){this.board=[],this.createBoard(),this.hits=[],this.misses=[],this.placedShips=[],this.gameOver=!1,this.sunkShips=[]}createBoard(){let e=0;for(let t=0;t<10;t++){this.board[t]=[];for(let n=0;n<10;n++)e++,this.board[t][n]=e}}placeShip(e,t,n){if(n&&!0===this.validPlacement(t,e.length,!0)){for(let n=0;n<e.length;n++){for(let n=0;n<this.board.length;n++)if(this.board[n].includes(t)){let s=this.board[n].indexOf(t);this.board[n][s]=e.name}t+=10}this.placedShips.push(e)}else if(!n&&!0===this.validPlacement(t,e.length,!1)){for(let n=0;n<e.length;n++){for(let n=0;n<this.board.length;n++)if(this.board[n].includes(t)){let s=this.board[n].indexOf(t);this.board[n][s]=e.name}t+=1}this.placedShips.push(e)}}recieveAttack(e,t){let n=e+t;Number.isInteger(this.board[e][t])?this.misses.push(n):(this.hits.push(n),this.placedShips.forEach((s=>{if(s.name===this.board[e][t])return s.hit(n),s.isSunk(),void(s.isSunk()&&this.sunkShips.push(s))})))}isOver(){return 4===this.sunkShips.length}validPlacement(e,t,n){let s=this.convertPosition(e),i=this.getRow(s),r=this.getCol(s);if(n&&i+t>10)return!1;if(!n&&r+t>10)return!1;if(n)for(let e=0;e<t;e++){if(!Number.isInteger(this.board[i][r]))return!1;i++}else for(let e=0;e<t;e++){if(!Number.isInteger(this.board[i][r]))return!1;r++}return!0}randomlyPlaceShips(e){let t,n,s=!1;for(;!s;)t=Math.floor(100*Math.random())+1,n=Math.random()<.5,this.validPlacement(t,e.length,n)?(s=!0,this.placeShip(e,t,n)):s=!1}convertPosition(e){let t,n,s=e.toString();return e<11?(t=e-1,n=0):100===e?(n=9,t=9):e%10==0?(n=parseInt(s.slice(0,1)),t=9):(n=parseInt(s.slice(0,1)),t=parseInt(s.slice(1,2))-1),n.toString()+t.toString()}getCol(e){return parseInt(e.slice(1,2))}getRow(e){return parseInt(e.slice(0,1))}}class t{constructor(t,n){this.gameboard=new e,this.name=t,this.shots=[],this.oponent=n}attack(e,t){let n=this.gameboard.convertPosition(e),s=this.gameboard.getRow(n),i=this.gameboard.getCol(n);this.shots.includes(e)||(this.shots.push(e),t.gameboard.recieveAttack(s,i),t.gameboard.isOver())}randomAttack(e){let t,n=!1;for(;!n;){t=Math.floor(100*Math.random())+1;let s=this.gameboard.convertPosition(t),i=this.gameboard.getRow(s),r=this.gameboard.getCol(s);if(!this.shots.includes(t))return console.log(t),this.shots.push(t),e.gameboard.recieveAttack(i,r),n=!0,t}}}class n{constructor(e,t){this.length=e,this.isHit=[],this.sunk=!1,this.name=t}hit(e){if(!this.isHit.includes(e)&&this.isHit.length<this.length)return this.isHit.push(e),this.isHit}isSunk(){return this.isHit.length===this.length&&(this.sunk=!0,!0)}}function s(e){document.querySelector("body");const s=document.querySelector(".info");null==s||s.classList.remove("info"),null==s||s.classList.add("hide");const i=document.querySelector("#main");i.classList.remove("hide"),i.classList.add("main"),document.querySelector(".content"),document.querySelector(".grid1");const r=document.querySelector(".grid-container1");document.querySelector(".title-1").textContent=e;const o=document.querySelector(".sunken1"),a=(document.querySelector(".grid2"),document.querySelector(".grid-container2")),l=(document.querySelector(".title-2"),document.querySelector(".sunken2")),d=document.querySelector(".who-won"),c=document.createElement("button");c.classList.add("restart"),c.textContent="Restart",c.addEventListener("click",(function(){location.reload()}));let h=new t("human","computer"),u=new t("computer","human"),m=h.gameboard.board,p=u.gameboard.board;const g=[new n(5,"carrier"),new n(4,"destroyer"),new n(3,"submarine"),new n(2,"patrol")];[new n(5,"carrier"),new n(4,"destroyer"),new n(3,"submarine"),new n(2,"patrol")].forEach((e=>{u.gameboard.randomlyPlaceShips(e)})),g.forEach((e=>{h.gameboard.randomlyPlaceShips(e)}));let b=0;for(let e=0;e<m.length;e++)for(let t=0;t<m[e].length;t++){b++;const n=document.createElement("div");n.setAttribute("hposition",b),Number.isInteger(m[e][t])||n.classList.add("ship-here"),n.classList.add("grid-item"),null==r||r.appendChild(n)}for(let t=0;t<p.length;t++)for(let n=0;n<p[t].length;n++){const s=document.createElement("div");s.setAttribute("cposition",p[t][n]),s.classList.add("grid-item"),s.classList.add("ai-grid"),s.addEventListener("click",(function(){if(s.classList.contains("hit")||s.classList.contains("miss")||h.gameboard.isOver()||u.gameboard.isOver())return;if(Number.isInteger(p[t][n]))s.classList.add("miss");else{s.classList.add("hit");let i=!1;if(u.gameboard.recieveAttack(t,n),u.gameboard.placedShips.forEach((e=>{e.name===p[t][n]&&(i=e.sunk)})),i){const s=document.createElement("h2");if(s.textContent=p[t][n],null==l||l.appendChild(s),u.gameboard.isOver()){const t=document.createElement("h1");t.textContent="Winner: "+e+"!",null==d||d.appendChild(t),null==d||d.appendChild(c)}}}let i;i=u.randomAttack(h);const r=document.querySelector(`[hposition="${i}"]`);let a=i,g=h.gameboard.convertPosition(a),b=h.gameboard.getRow(g),f=h.gameboard.getCol(g);if(Number.isInteger(h.gameboard.board[b][f]))null==r||r.classList.add("miss");else{null==r||r.classList.add("hit");let e=!1;if(h.gameboard.recieveAttack(t,n),h.gameboard.placedShips.forEach((t=>{t.name===m[b][f]&&(e=t.sunk)})),e){const e=document.createElement("h2");if(e.textContent=m[b][f],null==o||o.appendChild(e),h.gameboard.isOver()){const e=document.createElement("h1");e.textContent="Winner: Computer!",null==d||d.appendChild(e),null==d||d.appendChild(c)}}}})),null==a||a.appendChild(s)}}!function(){const e=document.querySelector(".info"),t=document.createElement("div");t.classList.add("input-container");const n=document.createElement("label");n.textContent="Enter Name:";const i=document.createElement("input");i.classList.add("name-input");const r=document.createElement("button");r.classList.add("start-button"),r.textContent="Start",t.appendChild(n),t.appendChild(i),t.appendChild(r),null==e||e.appendChild(t),r.addEventListener("click",(function(){if(""!==i.value){const n=i.value;null==e||e.removeChild(t),s(n)}else{const n="To lazy to enter a name";null==e||e.removeChild(t),s(n)}}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjLE1BQ3RDYyxFQUFPcEIsWUFBYyxvQkFDckJJLFNBQWdEQSxFQUFPYSxZQUFZRyxHQUNuRWhCLFNBQWdEQSxFQUFPYSxZQUFZWixFQUN2RSxDQUNKLENBQ0osQ0FJSixJQUNBSCxTQUE4Q0EsRUFBTWUsWUFBWUYsRUFDcEUsQ0FFUixFQzFJZSxXQUNYLE1BQU1yQixFQUFPRixTQUFTQyxjQUFjLFNBQzlCK0IsRUFBaUJoQyxTQUFTYyxjQUFjLE9BQzlDa0IsRUFBZTdCLFVBQVVFLElBQUksbUJBQzdCLE1BQU00QixFQUFZakMsU0FBU2MsY0FBYyxTQUN6Q21CLEVBQVV6QixZQUFjLGNBQ3hCLE1BQU0wQixFQUFZbEMsU0FBU2MsY0FBYyxTQUN6Q29CLEVBQVUvQixVQUFVRSxJQUFJLGNBQ3hCLE1BQU04QixFQUFjbkMsU0FBU2MsY0FBYyxVQUMzQ3FCLEVBQVloQyxVQUFVRSxJQUFJLGdCQUMxQjhCLEVBQVkzQixZQUFjLFFBQzFCd0IsRUFBZVAsWUFBWVEsR0FDM0JELEVBQWVQLFlBQVlTLEdBQzNCRixFQUFlUCxZQUFZVSxHQUMzQmpDLFNBQTRDQSxFQUFLdUIsWUFBWU8sR0FDN0RHLEVBQVlwQixpQkFBaUIsU0FBUyxXQUNsQyxHQUF3QixLQUFwQm1CLEVBQVVFLE1BQWMsQ0FDeEIsTUFBTS9FLEVBQU82RSxFQUFVRSxNQUN2QmxDLFNBQTRDQSxFQUFLbUMsWUFBWUwsR0FDN0RsQyxFQUFZekMsRUFDaEIsS0FDSyxDQUNELE1BQU1BLEVBQU8sMEJBQ2I2QyxTQUE0Q0EsRUFBS21DLFlBQVlMLEdBQzdEbEMsRUFBWXpDLEVBQ2hCLENBQ0osR0FDSixDQzNCQWlGLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9nYW1lYm9hcmQudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMvcGxheWVycy50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2ZhY3Rvcmllcy9zaGlwLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvdWkvcmVuZGVyR2FtZUJvYXJkcy50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3VpL3N0YXJ0R2FtZS50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB7IFNoaXAgfSBmcm9tICcuL3NoaXAnXHJcbmV4cG9ydCBjbGFzcyBHYW1lQm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5ib2FyZCA9IFtdO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlQm9hcmQoKTtcclxuICAgICAgICB0aGlzLmhpdHMgPSBbXTtcclxuICAgICAgICB0aGlzLm1pc3NlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMucGxhY2VkU2hpcHMgPSBbXTtcclxuICAgICAgICB0aGlzLmdhbWVPdmVyID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zdW5rU2hpcHMgPSBbXTtcclxuICAgIH1cclxuICAgIGNyZWF0ZUJvYXJkKCkge1xyXG4gICAgICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYm9hcmRbaV0gPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtpXVtqXSA9IGNvdW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcGxhY2VTaGlwKHNoaXAsIHN0YXJ0LCB2ZXJ0aWNhbCkge1xyXG4gICAgICAgIGlmICh2ZXJ0aWNhbCAmJiB0aGlzLnZhbGlkUGxhY2VtZW50KHN0YXJ0LCBzaGlwLmxlbmd0aCwgdHJ1ZSkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuYm9hcmQubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ib2FyZFtqXS5pbmNsdWRlcyhzdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5ib2FyZFtqXS5pbmRleE9mKHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtqXVtpbmRleF0gPSBzaGlwLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RhcnQgKz0gMTA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wbGFjZWRTaGlwcy5wdXNoKHNoaXApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghdmVydGljYWwgJiZcclxuICAgICAgICAgICAgdGhpcy52YWxpZFBsYWNlbWVudChzdGFydCwgc2hpcC5sZW5ndGgsIGZhbHNlKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5ib2FyZC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmJvYXJkW2pdLmluY2x1ZGVzKHN0YXJ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmJvYXJkW2pdLmluZGV4T2Yoc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2pdW2luZGV4XSA9IHNoaXAubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzdGFydCArPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VkU2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZWNpZXZlQXR0YWNrKHJvdywgY29sdW1uKSB7XHJcbiAgICAgICAgbGV0IHBvc2l0aW9uID0gcm93ICsgY29sdW1uO1xyXG4gICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcih0aGlzLmJvYXJkW3Jvd11bY29sdW1uXSkpIHtcclxuICAgICAgICAgICAgdGhpcy5oaXRzLnB1c2gocG9zaXRpb24pO1xyXG4gICAgICAgICAgICB0aGlzLnBsYWNlZFNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChzaGlwLm5hbWUgPT09IHRoaXMuYm9hcmRbcm93XVtjb2x1bW5dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcC5oaXQocG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaXAuaXNTdW5rKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoaXAuaXNTdW5rKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdW5rU2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubWlzc2VzLnB1c2gocG9zaXRpb24pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXNPdmVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN1bmtTaGlwcy5sZW5ndGggPT09IDQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHZhbGlkUGxhY2VtZW50KHBvc2l0aW9uLCBsZW5ndGgsIGlzVmVydGljYWwpIHtcclxuICAgICAgICBsZXQgbmV3UG9zaXRpb24gPSB0aGlzLmNvbnZlcnRQb3NpdGlvbihwb3NpdGlvbik7XHJcbiAgICAgICAgbGV0IHJvdyA9IHRoaXMuZ2V0Um93KG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICBsZXQgY29sdW1uID0gdGhpcy5nZXRDb2wobmV3UG9zaXRpb24pO1xyXG4gICAgICAgIGlmIChpc1ZlcnRpY2FsICYmIHJvdyArIGxlbmd0aCA+IDEwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoIWlzVmVydGljYWwgJiYgY29sdW1uICsgbGVuZ3RoID4gMTApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNWZXJ0aWNhbCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodGhpcy5ib2FyZFtyb3ddW2NvbHVtbl0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcm93Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcih0aGlzLmJvYXJkW3Jvd11bY29sdW1uXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4rKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKSB7XHJcbiAgICAgICAgbGV0IHZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHBvc2l0aW9uO1xyXG4gICAgICAgIGxldCBkaXJlY3Rpb247XHJcbiAgICAgICAgd2hpbGUgKCF2YWxpZCkge1xyXG4gICAgICAgICAgICBwb3NpdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkgKyAxO1xyXG4gICAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA8IDAuNSkge1xyXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkUGxhY2VtZW50KHBvc2l0aW9uLCBzaGlwLmxlbmd0aCwgZGlyZWN0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbGFjZVNoaXAoc2hpcCwgcG9zaXRpb24sIGRpcmVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb252ZXJ0UG9zaXRpb24ocG9zaXRpb24pIHtcclxuICAgICAgICBsZXQgY29sdW1uO1xyXG4gICAgICAgIGxldCBzdHIgPSBwb3NpdGlvbi50b1N0cmluZygpO1xyXG4gICAgICAgIGxldCByb3c7XHJcbiAgICAgICAgaWYgKHBvc2l0aW9uIDwgMTEpIHtcclxuICAgICAgICAgICAgY29sdW1uID0gcG9zaXRpb24gLSAxO1xyXG4gICAgICAgICAgICByb3cgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3NpdGlvbiA9PT0gMTAwKSB7XHJcbiAgICAgICAgICAgIHJvdyA9IDk7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IDk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvc2l0aW9uICUgMTAgPT09IDApIHtcclxuICAgICAgICAgICAgcm93ID0gcGFyc2VJbnQoc3RyLnNsaWNlKDAsIDEpKTtcclxuICAgICAgICAgICAgY29sdW1uID0gOTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJvdyA9IHBhcnNlSW50KHN0ci5zbGljZSgwLCAxKSk7XHJcbiAgICAgICAgICAgIGNvbHVtbiA9IHBhcnNlSW50KHN0ci5zbGljZSgxLCAyKSkgLSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgc3RyUm93ID0gcm93LnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IHN0ckNvbCA9IGNvbHVtbi50b1N0cmluZygpO1xyXG4gICAgICAgIGxldCBuZXdQb3NpdGlvbiA9IHN0clJvdyArIHN0ckNvbDtcclxuICAgICAgICByZXR1cm4gbmV3UG9zaXRpb247XHJcbiAgICB9XHJcbiAgICBnZXRDb2woc3RyKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHN0ci5zbGljZSgxLCAyKSk7XHJcbiAgICB9XHJcbiAgICBnZXRSb3coc3RyKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHN0ci5zbGljZSgwLCAxKSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgR2FtZUJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XHJcbmV4cG9ydCBjbGFzcyBQbGF5ZXIge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgb3BvbmVudCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZWJvYXJkID0gbmV3IEdhbWVCb2FyZCgpO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5zaG90cyA9IFtdO1xyXG4gICAgICAgIHRoaXMub3BvbmVudCA9IG9wb25lbnQ7XHJcbiAgICB9XHJcbiAgICBhdHRhY2socG9zaXRpb24sIG9wb25lbnQpIHtcclxuICAgICAgICBsZXQgbmV3UG9zaXRpb24gPSB0aGlzLmdhbWVib2FyZC5jb252ZXJ0UG9zaXRpb24ocG9zaXRpb24pO1xyXG4gICAgICAgIGxldCByb3cgPSB0aGlzLmdhbWVib2FyZC5nZXRSb3cobmV3UG9zaXRpb24pO1xyXG4gICAgICAgIGxldCBjb2wgPSB0aGlzLmdhbWVib2FyZC5nZXRDb2wobmV3UG9zaXRpb24pO1xyXG4gICAgICAgIGlmICghdGhpcy5zaG90cy5pbmNsdWRlcyhwb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG90cy5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgb3BvbmVudC5nYW1lYm9hcmQucmVjaWV2ZUF0dGFjayhyb3csIGNvbCk7XHJcbiAgICAgICAgICAgIGlmIChvcG9uZW50LmdhbWVib2FyZC5pc092ZXIoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJnZ1wiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmFuZG9tQXR0YWNrKG9wcG9uZW50KSB7XHJcbiAgICAgICAgbGV0IHZhbGlkU2hvdCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBwb3NpdGlvbjtcclxuICAgICAgICB3aGlsZSAoIXZhbGlkU2hvdCkge1xyXG4gICAgICAgICAgICBwb3NpdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkgKyAxO1xyXG4gICAgICAgICAgICBsZXQgbmV3UG9zaXRpb24gPSB0aGlzLmdhbWVib2FyZC5jb252ZXJ0UG9zaXRpb24ocG9zaXRpb24pO1xyXG4gICAgICAgICAgICBsZXQgcm93ID0gdGhpcy5nYW1lYm9hcmQuZ2V0Um93KG5ld1Bvc2l0aW9uKTtcclxuICAgICAgICAgICAgbGV0IGNvbCA9IHRoaXMuZ2FtZWJvYXJkLmdldENvbChuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zaG90cy5pbmNsdWRlcyhwb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvdHMucHVzaChwb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBvcHBvbmVudC5nYW1lYm9hcmQucmVjaWV2ZUF0dGFjayhyb3csIGNvbCk7XHJcbiAgICAgICAgICAgICAgICB2YWxpZFNob3QgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gbGV0IHN0cjogc3RyaW5nXHJcbiAgICAgICAgICAgICAgICAvLyBzdHIgPSByb3cudG9TdHJpbmcoKSArIGNvbC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFNoaXAge1xyXG4gICAgY29uc3RydWN0b3IobGVuZ3RoLCBuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XHJcbiAgICAgICAgdGhpcy5pc0hpdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3VuayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB9XHJcbiAgICBoaXQocG9zaXRpb24pIHtcclxuICAgICAgICAvL3B1c2ggcG9zaXRpb24gdG8gaXNoaXQgYXJyYXlcclxuICAgICAgICBpZiAoIXRoaXMuaXNIaXQuaW5jbHVkZXMocG9zaXRpb24pICYmIHRoaXMuaXNIaXQubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0hpdC5wdXNoKHBvc2l0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNIaXQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXNTdW5rKCkge1xyXG4gICAgICAgIC8vY2hlY2tzIGVhY2ggcG9zaXRpb24gb2Ygc2hpcCBmb3IgaGl0cyBpZiBhbGwgYXJlIGhpdCBpcyBzdW5rXHJcbiAgICAgICAgaWYgKHRoaXMuaXNIaXQubGVuZ3RoID09PSB0aGlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1bmsgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuLi9mYWN0b3JpZXMvcGxheWVyc1wiO1xyXG5pbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4uL2ZhY3Rvcmllcy9zaGlwXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlbmRlckdyaWRzKHBsYXllck5hbWUpIHtcclxuICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcclxuICAgIGNvbnN0IGluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uY2xhc3NMaXN0LnJlbW92ZShcImluZm9cIik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtYWluXCIpO1xyXG4gICAgbWFpbi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcclxuICAgIG1haW4uY2xhc3NMaXN0LmFkZChcIm1haW5cIik7XHJcbiAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKTtcclxuICAgIGNvbnN0IGdyaWRDb250YWluZXIxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkMVwiKTtcclxuICAgIGNvbnN0IGdyaWQxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkLWNvbnRhaW5lcjFcIik7XHJcbiAgICBjb25zdCB0aXRsZTEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRpdGxlLTFcIik7XHJcbiAgICB0aXRsZTEudGV4dENvbnRlbnQgPSBwbGF5ZXJOYW1lO1xyXG4gICAgY29uc3Qgc3Vua2VuMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3Vua2VuMVwiKTtcclxuICAgIGNvbnN0IGdyaWRDb250YWluZXIyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkMlwiKTtcclxuICAgIGNvbnN0IGdyaWQyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ncmlkLWNvbnRhaW5lcjJcIik7XHJcbiAgICBjb25zdCB0aXRsZTIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRpdGxlLTJcIik7XHJcbiAgICAvLyB0aXRsZTIudGV4dENvbnRlbnQgPSBcIkNvbXB1dGVyXCI7XHJcbiAgICBjb25zdCBzdW5rZW4yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdW5rZW4yXCIpO1xyXG4gICAgY29uc3Qgd2hvV29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aG8td29uXCIpO1xyXG4gICAgY29uc3QgcmVzdGFydCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICByZXN0YXJ0LmNsYXNzTGlzdC5hZGQoJ3Jlc3RhcnQnKTtcclxuICAgIHJlc3RhcnQudGV4dENvbnRlbnQgPSBcIlJlc3RhcnRcIjtcclxuICAgIHJlc3RhcnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgIH0pO1xyXG4gICAgbGV0IGh1bWFuID0gbmV3IFBsYXllcihcImh1bWFuXCIsIFwiY29tcHV0ZXJcIik7XHJcbiAgICBsZXQgY29tcHV0ZXIgPSBuZXcgUGxheWVyKFwiY29tcHV0ZXJcIiwgXCJodW1hblwiKTtcclxuICAgIGxldCBoQm9hcmQgPSBodW1hbi5nYW1lYm9hcmQuYm9hcmQ7XHJcbiAgICBsZXQgY0JvYXJkID0gY29tcHV0ZXIuZ2FtZWJvYXJkLmJvYXJkO1xyXG4gICAgbGV0IGhDYXJyaWVyID0gbmV3IFNoaXAoNSwgXCJjYXJyaWVyXCIpO1xyXG4gICAgbGV0IGhEZXN0cm95ZXIgPSBuZXcgU2hpcCg0LCBcImRlc3Ryb3llclwiKTtcclxuICAgIGxldCBoU3VibWFyaW5lID0gbmV3IFNoaXAoMywgXCJzdWJtYXJpbmVcIik7XHJcbiAgICBsZXQgaFBhdHJvbCA9IG5ldyBTaGlwKDIsIFwicGF0cm9sXCIpO1xyXG4gICAgbGV0IGNDYXJyaWVyID0gbmV3IFNoaXAoNSwgXCJjYXJyaWVyXCIpO1xyXG4gICAgbGV0IGNEZXN0cm95ZXIgPSBuZXcgU2hpcCg0LCBcImRlc3Ryb3llclwiKTtcclxuICAgIGxldCBjU3VibWFyaW5lID0gbmV3IFNoaXAoMywgXCJzdWJtYXJpbmVcIik7XHJcbiAgICBsZXQgY1BhdHJvbCA9IG5ldyBTaGlwKDIsIFwicGF0cm9sXCIpO1xyXG4gICAgY29uc3QgaHVtYW5TaGlwcyA9IFtoQ2FycmllciwgaERlc3Ryb3llciwgaFN1Ym1hcmluZSwgaFBhdHJvbF07XHJcbiAgICBjb25zdCBjb21wdXRlclNoaXBzID0gW2NDYXJyaWVyLCBjRGVzdHJveWVyLCBjU3VibWFyaW5lLCBjUGF0cm9sXTtcclxuICAgIC8vIGFsbFNoaXBzLmZvckVhY2goc2hpcCA9PiB7XHJcbiAgICAvLyAgICAgY29tcHV0ZXIuZ2FtZWJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcyhzaGlwKTtcclxuICAgIC8vICAgICBodW1hbi5nYW1lYm9hcmQucmFuZG9tbHlQbGFjZVNoaXBzKHNoaXApO1xyXG4gICAgLy8gfSlcclxuICAgIGNvbXB1dGVyU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgIGNvbXB1dGVyLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICB9KTtcclxuICAgIGh1bWFuU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgIGh1bWFuLmdhbWVib2FyZC5yYW5kb21seVBsYWNlU2hpcHMoc2hpcCk7XHJcbiAgICB9KTtcclxuICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhCb2FyZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaEJvYXJkW2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyaWRJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgZ3JpZEl0ZW0uc2V0QXR0cmlidXRlKFwiaHBvc2l0aW9uXCIsIGNvdW50KTtcclxuICAgICAgICAgICAgLy8gZ3JpZEl0ZW0udGV4dENvbnRlbnQgPSBib2FyZFtpXVtqXVxyXG4gICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoaEJvYXJkW2ldW2pdKSkge1xyXG4gICAgICAgICAgICAgICAgZ3JpZEl0ZW0uY2xhc3NMaXN0LmFkZChcInNoaXAtaGVyZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwiZ3JpZC1pdGVtXCIpO1xyXG4gICAgICAgICAgICBncmlkMSA9PT0gbnVsbCB8fCBncmlkMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZ3JpZDEuYXBwZW5kQ2hpbGQoZ3JpZEl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY0JvYXJkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjQm9hcmRbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZ3JpZEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5zZXRBdHRyaWJ1dGUoXCJjcG9zaXRpb25cIiwgY0JvYXJkW2ldW2pdKTtcclxuICAgICAgICAgICAgLy8gZ3JpZEl0ZW0udGV4dENvbnRlbnQgPSBib2FyZFtpXVtqXVxyXG4gICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwiZ3JpZC1pdGVtXCIpO1xyXG4gICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwiYWktZ3JpZFwiKTtcclxuICAgICAgICAgICAgZ3JpZEl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChncmlkSXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJoaXRcIikgfHxcclxuICAgICAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJtaXNzXCIpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgaHVtYW4uZ2FtZWJvYXJkLmlzT3ZlcigpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXIuZ2FtZWJvYXJkLmlzT3ZlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGNCb2FyZFtpXVtqXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBncmlkSXRlbS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpc1N1bmsgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBjb21wdXRlci5nYW1lYm9hcmQucmVjaWV2ZUF0dGFjayhpLCBqKTtcclxuICAgICAgICAgICAgICAgICAgICBjb21wdXRlci5nYW1lYm9hcmQucGxhY2VkU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcC5uYW1lID09PSBjQm9hcmRbaV1bal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU3VuayA9IHNoaXAuc3VuaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1N1bmspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vua2VuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdW5rZW4udGV4dENvbnRlbnQgPSBjQm9hcmRbaV1bal07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbjIgPT09IG51bGwgfHwgc3Vua2VuMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3Vua2VuMi5hcHBlbmRDaGlsZChzdW5rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcHV0ZXIuZ2FtZWJvYXJkLmlzT3ZlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3aW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBcIldpbm5lcjogXCIgKyBwbGF5ZXJOYW1lICsgXCIhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aG9Xb24gPT09IG51bGwgfHwgd2hvV29uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB3aG9Xb24uYXBwZW5kQ2hpbGQod2lubmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdob1dvbiA9PT0gbnVsbCB8fCB3aG9Xb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdob1dvbi5hcHBlbmRDaGlsZChyZXN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJdGVtLmNsYXNzTGlzdC5hZGQoXCJtaXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBjb21wdXRlci5yYW5kb21BdHRhY2soaHVtYW4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtocG9zaXRpb249XCIke3Bvc2l0aW9ufVwiXWApO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRlbXAgPSBwb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGxldCBuZXdQb3NpdGlvbiA9IGh1bWFuLmdhbWVib2FyZC5jb252ZXJ0UG9zaXRpb24odGVtcCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcm93ID0gaHVtYW4uZ2FtZWJvYXJkLmdldFJvdyhuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBsZXQgY29sID0gaHVtYW4uZ2FtZWJvYXJkLmdldENvbChuZXdQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoaHVtYW4uZ2FtZWJvYXJkLmJvYXJkW3Jvd11bY29sXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtID09PSBudWxsIHx8IGl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGl0ZW0uY2xhc3NMaXN0LmFkZChcImhpdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaXNTdW5rMSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5yZWNpZXZlQXR0YWNrKGksIGopO1xyXG4gICAgICAgICAgICAgICAgICAgIGh1bWFuLmdhbWVib2FyZC5wbGFjZWRTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGlwLm5hbWUgPT09IGhCb2FyZFtyb3ddW2NvbF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU3VuazEgPSBzaGlwLnN1bms7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdW5rMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW5rZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbi50ZXh0Q29udGVudCA9IGhCb2FyZFtyb3ddW2NvbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bmtlbjEgPT09IG51bGwgfHwgc3Vua2VuMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3Vua2VuMS5hcHBlbmRDaGlsZChzdW5rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHVtYW4uZ2FtZWJvYXJkLmlzT3ZlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3aW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBcIldpbm5lcjogQ29tcHV0ZXIhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aG9Xb24gPT09IG51bGwgfHwgd2hvV29uID09PSB2b2lkIDAgPyB2b2lkIDAgOiB3aG9Xb24uYXBwZW5kQ2hpbGQod2lubmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdob1dvbiA9PT0gbnVsbCB8fCB3aG9Xb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdob1dvbi5hcHBlbmRDaGlsZChyZXN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGdyaWQyID09PSBudWxsIHx8IGdyaWQyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBncmlkMi5hcHBlbmRDaGlsZChncmlkSXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCByZW5kZXJHcmlkcyBmcm9tIFwiLi9yZW5kZXJHYW1lQm9hcmRzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHN0YXJ0R2FtZSgpIHtcclxuICAgIGNvbnN0IGluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5mbycpO1xyXG4gICAgY29uc3QgaW5wdXRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGlucHV0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpbnB1dC1jb250YWluZXJcIik7XHJcbiAgICBjb25zdCBuYW1lTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xyXG4gICAgbmFtZUxhYmVsLnRleHRDb250ZW50ID0gXCJFbnRlciBOYW1lOlwiO1xyXG4gICAgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgIG5hbWVJbnB1dC5jbGFzc0xpc3QuYWRkKCduYW1lLWlucHV0Jyk7XHJcbiAgICBjb25zdCBzdGFydEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgc3RhcnRCdXR0b24uY2xhc3NMaXN0LmFkZChcInN0YXJ0LWJ1dHRvblwiKTtcclxuICAgIHN0YXJ0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTdGFydFwiO1xyXG4gICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQobmFtZUxhYmVsKTtcclxuICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKG5hbWVJbnB1dCk7XHJcbiAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChzdGFydEJ1dHRvbik7XHJcbiAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8uYXBwZW5kQ2hpbGQoaW5wdXRDb250YWluZXIpO1xyXG4gICAgc3RhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKG5hbWVJbnB1dC52YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IG5hbWVJbnB1dC52YWx1ZTtcclxuICAgICAgICAgICAgaW5mbyA9PT0gbnVsbCB8fCBpbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmZvLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKTtcclxuICAgICAgICAgICAgcmVuZGVyR3JpZHMobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gXCJUbyBsYXp5IHRvIGVudGVyIGEgbmFtZVwiO1xyXG4gICAgICAgICAgICBpbmZvID09PSBudWxsIHx8IGluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluZm8ucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpO1xyXG4gICAgICAgICAgICByZW5kZXJHcmlkcyhuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4iLCJpbXBvcnQgc3RhcnRHYW1lIGZyb20gXCIuL3VpL3N0YXJ0R2FtZVwiO1xyXG5zdGFydEdhbWUoKTtcclxuLy8gcmVuZGVyR3JpZHMoJ2pqY3JhenltYW4nKVxyXG4iXSwibmFtZXMiOlsiR2FtZUJvYXJkIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiYm9hcmQiLCJjcmVhdGVCb2FyZCIsImhpdHMiLCJtaXNzZXMiLCJwbGFjZWRTaGlwcyIsImdhbWVPdmVyIiwic3Vua1NoaXBzIiwiY291bnQiLCJpIiwiaiIsInBsYWNlU2hpcCIsInNoaXAiLCJzdGFydCIsInZlcnRpY2FsIiwidmFsaWRQbGFjZW1lbnQiLCJsZW5ndGgiLCJpbmNsdWRlcyIsImluZGV4IiwiaW5kZXhPZiIsIm5hbWUiLCJwdXNoIiwicmVjaWV2ZUF0dGFjayIsInJvdyIsImNvbHVtbiIsInBvc2l0aW9uIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiZm9yRWFjaCIsImhpdCIsImlzU3VuayIsImlzT3ZlciIsImlzVmVydGljYWwiLCJuZXdQb3NpdGlvbiIsImNvbnZlcnRQb3NpdGlvbiIsImdldFJvdyIsImdldENvbCIsInJhbmRvbWx5UGxhY2VTaGlwcyIsImRpcmVjdGlvbiIsInZhbGlkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic3RyIiwidG9TdHJpbmciLCJwYXJzZUludCIsInNsaWNlIiwiUGxheWVyIiwib3BvbmVudCIsImdhbWVib2FyZCIsInNob3RzIiwiYXR0YWNrIiwiY29sIiwicmFuZG9tQXR0YWNrIiwib3Bwb25lbnQiLCJ2YWxpZFNob3QiLCJjb25zb2xlIiwibG9nIiwiU2hpcCIsImlzSGl0Iiwic3VuayIsInJlbmRlckdyaWRzIiwicGxheWVyTmFtZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImluZm8iLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJtYWluIiwiZ3JpZDEiLCJ0ZXh0Q29udGVudCIsInN1bmtlbjEiLCJncmlkMiIsInN1bmtlbjIiLCJ3aG9Xb24iLCJyZXN0YXJ0IiwiY3JlYXRlRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJsb2NhdGlvbiIsInJlbG9hZCIsImh1bWFuIiwiY29tcHV0ZXIiLCJoQm9hcmQiLCJjQm9hcmQiLCJodW1hblNoaXBzIiwiZ3JpZEl0ZW0iLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImNvbnRhaW5zIiwic3Vua2VuIiwid2lubmVyIiwiaXRlbSIsInRlbXAiLCJpc1N1bmsxIiwiaW5wdXRDb250YWluZXIiLCJuYW1lTGFiZWwiLCJuYW1lSW5wdXQiLCJzdGFydEJ1dHRvbiIsInZhbHVlIiwicmVtb3ZlQ2hpbGQiLCJzdGFydEdhbWUiXSwic291cmNlUm9vdCI6IiJ9